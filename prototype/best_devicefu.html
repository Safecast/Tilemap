<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" itemscope itemtype="http://schema.org/map" style="height:100%">
<head>
<title>[PROTOTYPE] Ingest Device Grid</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name=viewport content="width=device-width, initial-scale=1">

<link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">

<!--
<link rel="stylesheet" href="font-awesome-4.7.0/css/font-awesome.min.css">
/-->

<link href="emoji/ap-64-emoji.min.css" rel="stylesheet">
<style type="text/css">
/* https://github.com/juanfran/emoji-data-css */

.ap
{
    /*transform:scale(0.1875); */   /* 64x64px -> 12x12px */
    /* transform:scale(0.375); */   /* 32x32px -> 12x12px */
    transform:scale(0.171875);      /* 64x64px -> 11x11px */
    transform-origin:0 0;
}

.ap.gray        { filter:grayscale(100%) contrast(500%); }
.font_large .ap { transform:scale(0.265625); }     /* 64x64px -> 17x17px */

.item_tag.old .ap
{
    /*-webkit-filter: url(#colorize_orange);*/
    filter: url(#colorize_orange);
    /* filter:url(#colorize_red) hue-rotate(45deg); */
}

.item_tag.err .ap
{
    /*-webkit-filter: url(#colorize_red);*/
    filter: url(#colorize_red);
}

.ap.twitter   { background-image: url(emoji/sheet_twitter_64_indexed_256.png)   !important; }
.ap.emojione  { background-image: url(emoji/sheet_emojione_64_indexed_256.png)  !important; }
.ap.messenger { background-image: url(emoji/sheet_messenger_64_indexed_256.png) !important; }
.ap.android   { background-image: url(emoji/sheet_google_64_indexed_256.png)    !important; }
.ap.facebook  { background-image: url(emoji/sheet_facebook_64_indexed_256.png)  !important; }
.ap.apple     { background-image: url(emoji/sheet_apple_64_indexed_256.png)     !important; }

.fa-container
{
    display:inline-block;
    vertical-align:middle;
}

.ap-container
{
    width:11px;
    height:11px;
    display:inline-block;
    vertical-align:middle;
}

.font_large .ap-container
{
    width:17px;
    height:17px;
}

.ap-thermometer_blue
{
    background-position:-384px -832px;
    /* filter:invert(100%) brightness(200%); */
    filter:hue-rotate(250deg);
}

.ap.gray .ap-thermometer_blue
{
    filter:hue-rotate(250deg) grayscale(100%) contrast(2.0);
}

.ap-label
{
    display:inline-block;
    vertical-align:middle;
    margin:2px 0px 2px 1px;
}

.font_large .ap-label { margin-left:2px; }
</style>

<style type="text/css">
.tooltip
{
    position:relative;
    display:inline-block;
}

.tooltip.up   .tooltiptext { bottom:150%; }
.tooltip.down .tooltiptext {    top:150%; }

.tooltip .tooltiptext
{
    visibility:hidden;
    width:120px;
    background-color:rgba(0,0,0,0.75);
    color:#FFF;
    text-align:center;
    border-radius:6px;
    padding:5px 0;
    position:absolute;
    z-index:1000;
    left:50%;
    margin-left:-60px;
    font-size:12px;
    font-weight:normal;
}

.tooltip.wide .tooltiptext
{
    width:180px;
    margin-left:-90px;
    font-size:14px;
}

.tooltip.narrow .tooltiptext
{
    width:60px;
    margin-left:-30px;
    font-size:10px;
}


.tooltip.up   .tooltiptext::after {    top:100%; border-color:black transparent transparent transparent; }
.tooltip.down .tooltiptext::after { bottom:100%; border-color:transparent transparent black transparent; }

.tooltip .tooltiptext::after
{
    content:"";
    position:absolute;
    left:50%;
    margin-left:-5px;
    border-width:5px;
    border-style:solid;
}

.tooltip:hover .tooltiptext { visibility: visible; }

.device_card.nodt.hiddenlines1 .tooltip.down .tooltiptext,
.device_card.nodt.hiddenlines2 .tooltip.down .tooltiptext,
.device_card.nodt.hiddenlines3 .tooltip.down .tooltiptext
{
    top:-50%;
    font-size:12px;
}

.device_card.nodt.hiddenlines1 .tooltip.down .tooltiptext::after,
.device_card.nodt.hiddenlines2 .tooltip.down .tooltiptext::after,
.device_card.nodt.hiddenlines3 .tooltip.down .tooltiptext::after
{
    bottom:-50%;
    font-size:12px;
}
</style>

<style type="text/css">
/* https://github.com/lipis/flag-icon-css */
.flag-icon,.flag-icon-background{background-size:contain;background-position:50%;background-repeat:no-repeat}.flag-icon{position:relative;display:inline-block;width:1.33333333em;line-height:1em}.flag-icon:before{content:"\00a0"}.flag-icon.flag-icon-squared{width:1em}.flag-icon-ad{background-image:url(flags/4x3/ad.svg)}.flag-icon-ad.flag-icon-squared{background-image:url(flags/1x1/ad.svg)}.flag-icon-ae{background-image:url(flags/4x3/ae.svg)}.flag-icon-ae.flag-icon-squared{background-image:url(flags/1x1/ae.svg)}.flag-icon-af{background-image:url(flags/4x3/af.svg)}.flag-icon-af.flag-icon-squared{background-image:url(flags/1x1/af.svg)}.flag-icon-ag{background-image:url(flags/4x3/ag.svg)}.flag-icon-ag.flag-icon-squared{background-image:url(flags/1x1/ag.svg)}.flag-icon-ai{background-image:url(flags/4x3/ai.svg)}.flag-icon-ai.flag-icon-squared{background-image:url(flags/1x1/ai.svg)}.flag-icon-al{background-image:url(flags/4x3/al.svg)}.flag-icon-al.flag-icon-squared{background-image:url(flags/1x1/al.svg)}.flag-icon-am{background-image:url(flags/4x3/am.svg)}.flag-icon-am.flag-icon-squared{background-image:url(flags/1x1/am.svg)}.flag-icon-ao{background-image:url(flags/4x3/ao.svg)}.flag-icon-ao.flag-icon-squared{background-image:url(flags/1x1/ao.svg)}.flag-icon-aq{background-image:url(flags/4x3/aq.svg)}.flag-icon-aq.flag-icon-squared{background-image:url(flags/1x1/aq.svg)}.flag-icon-ar{background-image:url(flags/4x3/ar.svg)}.flag-icon-ar.flag-icon-squared{background-image:url(flags/1x1/ar.svg)}.flag-icon-as{background-image:url(flags/4x3/as.svg)}.flag-icon-as.flag-icon-squared{background-image:url(flags/1x1/as.svg)}.flag-icon-at{background-image:url(flags/4x3/at.svg)}.flag-icon-at.flag-icon-squared{background-image:url(flags/1x1/at.svg)}.flag-icon-au{background-image:url(flags/4x3/au.svg)}.flag-icon-au.flag-icon-squared{background-image:url(flags/1x1/au.svg)}.flag-icon-aw{background-image:url(flags/4x3/aw.svg)}.flag-icon-aw.flag-icon-squared{background-image:url(flags/1x1/aw.svg)}.flag-icon-ax{background-image:url(flags/4x3/ax.svg)}.flag-icon-ax.flag-icon-squared{background-image:url(flags/1x1/ax.svg)}.flag-icon-az{background-image:url(flags/4x3/az.svg)}.flag-icon-az.flag-icon-squared{background-image:url(flags/1x1/az.svg)}.flag-icon-ba{background-image:url(flags/4x3/ba.svg)}.flag-icon-ba.flag-icon-squared{background-image:url(flags/1x1/ba.svg)}.flag-icon-bb{background-image:url(flags/4x3/bb.svg)}.flag-icon-bb.flag-icon-squared{background-image:url(flags/1x1/bb.svg)}.flag-icon-bd{background-image:url(flags/4x3/bd.svg)}.flag-icon-bd.flag-icon-squared{background-image:url(flags/1x1/bd.svg)}.flag-icon-be{background-image:url(flags/4x3/be.svg)}.flag-icon-be.flag-icon-squared{background-image:url(flags/1x1/be.svg)}.flag-icon-bf{background-image:url(flags/4x3/bf.svg)}.flag-icon-bf.flag-icon-squared{background-image:url(flags/1x1/bf.svg)}.flag-icon-bg{background-image:url(flags/4x3/bg.svg)}.flag-icon-bg.flag-icon-squared{background-image:url(flags/1x1/bg.svg)}.flag-icon-bh{background-image:url(flags/4x3/bh.svg)}.flag-icon-bh.flag-icon-squared{background-image:url(flags/1x1/bh.svg)}.flag-icon-bi{background-image:url(flags/4x3/bi.svg)}.flag-icon-bi.flag-icon-squared{background-image:url(flags/1x1/bi.svg)}.flag-icon-bj{background-image:url(flags/4x3/bj.svg)}.flag-icon-bj.flag-icon-squared{background-image:url(flags/1x1/bj.svg)}.flag-icon-bl{background-image:url(flags/4x3/bl.svg)}.flag-icon-bl.flag-icon-squared{background-image:url(flags/1x1/bl.svg)}.flag-icon-bm{background-image:url(flags/4x3/bm.svg)}.flag-icon-bm.flag-icon-squared{background-image:url(flags/1x1/bm.svg)}.flag-icon-bn{background-image:url(flags/4x3/bn.svg)}.flag-icon-bn.flag-icon-squared{background-image:url(flags/1x1/bn.svg)}.flag-icon-bo{background-image:url(flags/4x3/bo.svg)}.flag-icon-bo.flag-icon-squared{background-image:url(flags/1x1/bo.svg)}.flag-icon-bq{background-image:url(flags/4x3/bq.svg)}.flag-icon-bq.flag-icon-squared{background-image:url(flags/1x1/bq.svg)}.flag-icon-br{background-image:url(flags/4x3/br.svg)}.flag-icon-br.flag-icon-squared{background-image:url(flags/1x1/br.svg)}.flag-icon-bs{background-image:url(flags/4x3/bs.svg)}.flag-icon-bs.flag-icon-squared{background-image:url(flags/1x1/bs.svg)}.flag-icon-bt{background-image:url(flags/4x3/bt.svg)}.flag-icon-bt.flag-icon-squared{background-image:url(flags/1x1/bt.svg)}.flag-icon-bv{background-image:url(flags/4x3/bv.svg)}.flag-icon-bv.flag-icon-squared{background-image:url(flags/1x1/bv.svg)}.flag-icon-bw{background-image:url(flags/4x3/bw.svg)}.flag-icon-bw.flag-icon-squared{background-image:url(flags/1x1/bw.svg)}.flag-icon-by{background-image:url(flags/4x3/by.svg)}.flag-icon-by.flag-icon-squared{background-image:url(flags/1x1/by.svg)}.flag-icon-bz{background-image:url(flags/4x3/bz.svg)}.flag-icon-bz.flag-icon-squared{background-image:url(flags/1x1/bz.svg)}.flag-icon-ca{background-image:url(flags/4x3/ca.svg)}.flag-icon-ca.flag-icon-squared{background-image:url(flags/1x1/ca.svg)}.flag-icon-cc{background-image:url(flags/4x3/cc.svg)}.flag-icon-cc.flag-icon-squared{background-image:url(flags/1x1/cc.svg)}.flag-icon-cd{background-image:url(flags/4x3/cd.svg)}.flag-icon-cd.flag-icon-squared{background-image:url(flags/1x1/cd.svg)}.flag-icon-cf{background-image:url(flags/4x3/cf.svg)}.flag-icon-cf.flag-icon-squared{background-image:url(flags/1x1/cf.svg)}.flag-icon-cg{background-image:url(flags/4x3/cg.svg)}.flag-icon-cg.flag-icon-squared{background-image:url(flags/1x1/cg.svg)}.flag-icon-ch{background-image:url(flags/4x3/ch.svg)}.flag-icon-ch.flag-icon-squared{background-image:url(flags/1x1/ch.svg)}.flag-icon-ci{background-image:url(flags/4x3/ci.svg)}.flag-icon-ci.flag-icon-squared{background-image:url(flags/1x1/ci.svg)}.flag-icon-ck{background-image:url(flags/4x3/ck.svg)}.flag-icon-ck.flag-icon-squared{background-image:url(flags/1x1/ck.svg)}.flag-icon-cl{background-image:url(flags/4x3/cl.svg)}.flag-icon-cl.flag-icon-squared{background-image:url(flags/1x1/cl.svg)}.flag-icon-cm{background-image:url(flags/4x3/cm.svg)}.flag-icon-cm.flag-icon-squared{background-image:url(flags/1x1/cm.svg)}.flag-icon-cn{background-image:url(flags/4x3/cn.svg)}.flag-icon-cn.flag-icon-squared{background-image:url(flags/1x1/cn.svg)}.flag-icon-co{background-image:url(flags/4x3/co.svg)}.flag-icon-co.flag-icon-squared{background-image:url(flags/1x1/co.svg)}.flag-icon-cr{background-image:url(flags/4x3/cr.svg)}.flag-icon-cr.flag-icon-squared{background-image:url(flags/1x1/cr.svg)}.flag-icon-cu{background-image:url(flags/4x3/cu.svg)}.flag-icon-cu.flag-icon-squared{background-image:url(flags/1x1/cu.svg)}.flag-icon-cv{background-image:url(flags/4x3/cv.svg)}.flag-icon-cv.flag-icon-squared{background-image:url(flags/1x1/cv.svg)}.flag-icon-cw{background-image:url(flags/4x3/cw.svg)}.flag-icon-cw.flag-icon-squared{background-image:url(flags/1x1/cw.svg)}.flag-icon-cx{background-image:url(flags/4x3/cx.svg)}.flag-icon-cx.flag-icon-squared{background-image:url(flags/1x1/cx.svg)}.flag-icon-cy{background-image:url(flags/4x3/cy.svg)}.flag-icon-cy.flag-icon-squared{background-image:url(flags/1x1/cy.svg)}.flag-icon-cz{background-image:url(flags/4x3/cz.svg)}.flag-icon-cz.flag-icon-squared{background-image:url(flags/1x1/cz.svg)}.flag-icon-de{background-image:url(flags/4x3/de.svg)}.flag-icon-de.flag-icon-squared{background-image:url(flags/1x1/de.svg)}.flag-icon-dj{background-image:url(flags/4x3/dj.svg)}.flag-icon-dj.flag-icon-squared{background-image:url(flags/1x1/dj.svg)}.flag-icon-dk{background-image:url(flags/4x3/dk.svg)}.flag-icon-dk.flag-icon-squared{background-image:url(flags/1x1/dk.svg)}.flag-icon-dm{background-image:url(flags/4x3/dm.svg)}.flag-icon-dm.flag-icon-squared{background-image:url(flags/1x1/dm.svg)}.flag-icon-do{background-image:url(flags/4x3/do.svg)}.flag-icon-do.flag-icon-squared{background-image:url(flags/1x1/do.svg)}.flag-icon-dz{background-image:url(flags/4x3/dz.svg)}.flag-icon-dz.flag-icon-squared{background-image:url(flags/1x1/dz.svg)}.flag-icon-ec{background-image:url(flags/4x3/ec.svg)}.flag-icon-ec.flag-icon-squared{background-image:url(flags/1x1/ec.svg)}.flag-icon-ee{background-image:url(flags/4x3/ee.svg)}.flag-icon-ee.flag-icon-squared{background-image:url(flags/1x1/ee.svg)}.flag-icon-eg{background-image:url(flags/4x3/eg.svg)}.flag-icon-eg.flag-icon-squared{background-image:url(flags/1x1/eg.svg)}.flag-icon-eh{background-image:url(flags/4x3/eh.svg)}.flag-icon-eh.flag-icon-squared{background-image:url(flags/1x1/eh.svg)}.flag-icon-er{background-image:url(flags/4x3/er.svg)}.flag-icon-er.flag-icon-squared{background-image:url(flags/1x1/er.svg)}.flag-icon-es{background-image:url(flags/4x3/es.svg)}.flag-icon-es.flag-icon-squared{background-image:url(flags/1x1/es.svg)}.flag-icon-et{background-image:url(flags/4x3/et.svg)}.flag-icon-et.flag-icon-squared{background-image:url(flags/1x1/et.svg)}.flag-icon-fi{background-image:url(flags/4x3/fi.svg)}.flag-icon-fi.flag-icon-squared{background-image:url(flags/1x1/fi.svg)}.flag-icon-fj{background-image:url(flags/4x3/fj.svg)}.flag-icon-fj.flag-icon-squared{background-image:url(flags/1x1/fj.svg)}.flag-icon-fk{background-image:url(flags/4x3/fk.svg)}.flag-icon-fk.flag-icon-squared{background-image:url(flags/1x1/fk.svg)}.flag-icon-fm{background-image:url(flags/4x3/fm.svg)}.flag-icon-fm.flag-icon-squared{background-image:url(flags/1x1/fm.svg)}.flag-icon-fo{background-image:url(flags/4x3/fo.svg)}.flag-icon-fo.flag-icon-squared{background-image:url(flags/1x1/fo.svg)}.flag-icon-fr{background-image:url(flags/4x3/fr.svg)}.flag-icon-fr.flag-icon-squared{background-image:url(flags/1x1/fr.svg)}.flag-icon-ga{background-image:url(flags/4x3/ga.svg)}.flag-icon-ga.flag-icon-squared{background-image:url(flags/1x1/ga.svg)}.flag-icon-gb{background-image:url(flags/4x3/gb.svg)}.flag-icon-gb.flag-icon-squared{background-image:url(flags/1x1/gb.svg)}.flag-icon-gd{background-image:url(flags/4x3/gd.svg)}.flag-icon-gd.flag-icon-squared{background-image:url(flags/1x1/gd.svg)}.flag-icon-ge{background-image:url(flags/4x3/ge.svg)}.flag-icon-ge.flag-icon-squared{background-image:url(flags/1x1/ge.svg)}.flag-icon-gf{background-image:url(flags/4x3/gf.svg)}.flag-icon-gf.flag-icon-squared{background-image:url(flags/1x1/gf.svg)}.flag-icon-gg{background-image:url(flags/4x3/gg.svg)}.flag-icon-gg.flag-icon-squared{background-image:url(flags/1x1/gg.svg)}.flag-icon-gh{background-image:url(flags/4x3/gh.svg)}.flag-icon-gh.flag-icon-squared{background-image:url(flags/1x1/gh.svg)}.flag-icon-gi{background-image:url(flags/4x3/gi.svg)}.flag-icon-gi.flag-icon-squared{background-image:url(flags/1x1/gi.svg)}.flag-icon-gl{background-image:url(flags/4x3/gl.svg)}.flag-icon-gl.flag-icon-squared{background-image:url(flags/1x1/gl.svg)}.flag-icon-gm{background-image:url(flags/4x3/gm.svg)}.flag-icon-gm.flag-icon-squared{background-image:url(flags/1x1/gm.svg)}.flag-icon-gn{background-image:url(flags/4x3/gn.svg)}.flag-icon-gn.flag-icon-squared{background-image:url(flags/1x1/gn.svg)}.flag-icon-gp{background-image:url(flags/4x3/gp.svg)}.flag-icon-gp.flag-icon-squared{background-image:url(flags/1x1/gp.svg)}.flag-icon-gq{background-image:url(flags/4x3/gq.svg)}.flag-icon-gq.flag-icon-squared{background-image:url(flags/1x1/gq.svg)}.flag-icon-gr{background-image:url(flags/4x3/gr.svg)}.flag-icon-gr.flag-icon-squared{background-image:url(flags/1x1/gr.svg)}.flag-icon-gs{background-image:url(flags/4x3/gs.svg)}.flag-icon-gs.flag-icon-squared{background-image:url(flags/1x1/gs.svg)}.flag-icon-gt{background-image:url(flags/4x3/gt.svg)}.flag-icon-gt.flag-icon-squared{background-image:url(flags/1x1/gt.svg)}.flag-icon-gu{background-image:url(flags/4x3/gu.svg)}.flag-icon-gu.flag-icon-squared{background-image:url(flags/1x1/gu.svg)}.flag-icon-gw{background-image:url(flags/4x3/gw.svg)}.flag-icon-gw.flag-icon-squared{background-image:url(flags/1x1/gw.svg)}.flag-icon-gy{background-image:url(flags/4x3/gy.svg)}.flag-icon-gy.flag-icon-squared{background-image:url(flags/1x1/gy.svg)}.flag-icon-hk{background-image:url(flags/4x3/hk.svg)}.flag-icon-hk.flag-icon-squared{background-image:url(flags/1x1/hk.svg)}.flag-icon-hm{background-image:url(flags/4x3/hm.svg)}.flag-icon-hm.flag-icon-squared{background-image:url(flags/1x1/hm.svg)}.flag-icon-hn{background-image:url(flags/4x3/hn.svg)}.flag-icon-hn.flag-icon-squared{background-image:url(flags/1x1/hn.svg)}.flag-icon-hr{background-image:url(flags/4x3/hr.svg)}.flag-icon-hr.flag-icon-squared{background-image:url(flags/1x1/hr.svg)}.flag-icon-ht{background-image:url(flags/4x3/ht.svg)}.flag-icon-ht.flag-icon-squared{background-image:url(flags/1x1/ht.svg)}.flag-icon-hu{background-image:url(flags/4x3/hu.svg)}.flag-icon-hu.flag-icon-squared{background-image:url(flags/1x1/hu.svg)}.flag-icon-id{background-image:url(flags/4x3/id.svg)}.flag-icon-id.flag-icon-squared{background-image:url(flags/1x1/id.svg)}.flag-icon-ie{background-image:url(flags/4x3/ie.svg)}.flag-icon-ie.flag-icon-squared{background-image:url(flags/1x1/ie.svg)}.flag-icon-il{background-image:url(flags/4x3/il.svg)}.flag-icon-il.flag-icon-squared{background-image:url(flags/1x1/il.svg)}.flag-icon-im{background-image:url(flags/4x3/im.svg)}.flag-icon-im.flag-icon-squared{background-image:url(flags/1x1/im.svg)}.flag-icon-in{background-image:url(flags/4x3/in.svg)}.flag-icon-in.flag-icon-squared{background-image:url(flags/1x1/in.svg)}.flag-icon-io{background-image:url(flags/4x3/io.svg)}.flag-icon-io.flag-icon-squared{background-image:url(flags/1x1/io.svg)}.flag-icon-iq{background-image:url(flags/4x3/iq.svg)}.flag-icon-iq.flag-icon-squared{background-image:url(flags/1x1/iq.svg)}.flag-icon-ir{background-image:url(flags/4x3/ir.svg)}.flag-icon-ir.flag-icon-squared{background-image:url(flags/1x1/ir.svg)}.flag-icon-is{background-image:url(flags/4x3/is.svg)}.flag-icon-is.flag-icon-squared{background-image:url(flags/1x1/is.svg)}.flag-icon-it{background-image:url(flags/4x3/it.svg)}.flag-icon-it.flag-icon-squared{background-image:url(flags/1x1/it.svg)}.flag-icon-je{background-image:url(flags/4x3/je.svg)}.flag-icon-je.flag-icon-squared{background-image:url(flags/1x1/je.svg)}.flag-icon-jm{background-image:url(flags/4x3/jm.svg)}.flag-icon-jm.flag-icon-squared{background-image:url(flags/1x1/jm.svg)}.flag-icon-jo{background-image:url(flags/4x3/jo.svg)}.flag-icon-jo.flag-icon-squared{background-image:url(flags/1x1/jo.svg)}.flag-icon-jp{background-image:url(flags/4x3/jp.svg)}.flag-icon-jp.flag-icon-squared{background-image:url(flags/1x1/jp.svg)}.flag-icon-ke{background-image:url(flags/4x3/ke.svg)}.flag-icon-ke.flag-icon-squared{background-image:url(flags/1x1/ke.svg)}.flag-icon-kg{background-image:url(flags/4x3/kg.svg)}.flag-icon-kg.flag-icon-squared{background-image:url(flags/1x1/kg.svg)}.flag-icon-kh{background-image:url(flags/4x3/kh.svg)}.flag-icon-kh.flag-icon-squared{background-image:url(flags/1x1/kh.svg)}.flag-icon-ki{background-image:url(flags/4x3/ki.svg)}.flag-icon-ki.flag-icon-squared{background-image:url(flags/1x1/ki.svg)}.flag-icon-km{background-image:url(flags/4x3/km.svg)}.flag-icon-km.flag-icon-squared{background-image:url(flags/1x1/km.svg)}.flag-icon-kn{background-image:url(flags/4x3/kn.svg)}.flag-icon-kn.flag-icon-squared{background-image:url(flags/1x1/kn.svg)}.flag-icon-kp{background-image:url(flags/4x3/kp.svg)}.flag-icon-kp.flag-icon-squared{background-image:url(flags/1x1/kp.svg)}.flag-icon-kr{background-image:url(flags/4x3/kr.svg)}.flag-icon-kr.flag-icon-squared{background-image:url(flags/1x1/kr.svg)}.flag-icon-kw{background-image:url(flags/4x3/kw.svg)}.flag-icon-kw.flag-icon-squared{background-image:url(flags/1x1/kw.svg)}.flag-icon-ky{background-image:url(flags/4x3/ky.svg)}.flag-icon-ky.flag-icon-squared{background-image:url(flags/1x1/ky.svg)}.flag-icon-kz{background-image:url(flags/4x3/kz.svg)}.flag-icon-kz.flag-icon-squared{background-image:url(flags/1x1/kz.svg)}.flag-icon-la{background-image:url(flags/4x3/la.svg)}.flag-icon-la.flag-icon-squared{background-image:url(flags/1x1/la.svg)}.flag-icon-lb{background-image:url(flags/4x3/lb.svg)}.flag-icon-lb.flag-icon-squared{background-image:url(flags/1x1/lb.svg)}.flag-icon-lc{background-image:url(flags/4x3/lc.svg)}.flag-icon-lc.flag-icon-squared{background-image:url(flags/1x1/lc.svg)}.flag-icon-li{background-image:url(flags/4x3/li.svg)}.flag-icon-li.flag-icon-squared{background-image:url(flags/1x1/li.svg)}.flag-icon-lk{background-image:url(flags/4x3/lk.svg)}.flag-icon-lk.flag-icon-squared{background-image:url(flags/1x1/lk.svg)}.flag-icon-lr{background-image:url(flags/4x3/lr.svg)}.flag-icon-lr.flag-icon-squared{background-image:url(flags/1x1/lr.svg)}.flag-icon-ls{background-image:url(flags/4x3/ls.svg)}.flag-icon-ls.flag-icon-squared{background-image:url(flags/1x1/ls.svg)}.flag-icon-lt{background-image:url(flags/4x3/lt.svg)}.flag-icon-lt.flag-icon-squared{background-image:url(flags/1x1/lt.svg)}.flag-icon-lu{background-image:url(flags/4x3/lu.svg)}.flag-icon-lu.flag-icon-squared{background-image:url(flags/1x1/lu.svg)}.flag-icon-lv{background-image:url(flags/4x3/lv.svg)}.flag-icon-lv.flag-icon-squared{background-image:url(flags/1x1/lv.svg)}.flag-icon-ly{background-image:url(flags/4x3/ly.svg)}.flag-icon-ly.flag-icon-squared{background-image:url(flags/1x1/ly.svg)}.flag-icon-ma{background-image:url(flags/4x3/ma.svg)}.flag-icon-ma.flag-icon-squared{background-image:url(flags/1x1/ma.svg)}.flag-icon-mc{background-image:url(flags/4x3/mc.svg)}.flag-icon-mc.flag-icon-squared{background-image:url(flags/1x1/mc.svg)}.flag-icon-md{background-image:url(flags/4x3/md.svg)}.flag-icon-md.flag-icon-squared{background-image:url(flags/1x1/md.svg)}.flag-icon-me{background-image:url(flags/4x3/me.svg)}.flag-icon-me.flag-icon-squared{background-image:url(flags/1x1/me.svg)}.flag-icon-mf{background-image:url(flags/4x3/mf.svg)}.flag-icon-mf.flag-icon-squared{background-image:url(flags/1x1/mf.svg)}.flag-icon-mg{background-image:url(flags/4x3/mg.svg)}.flag-icon-mg.flag-icon-squared{background-image:url(flags/1x1/mg.svg)}.flag-icon-mh{background-image:url(flags/4x3/mh.svg)}.flag-icon-mh.flag-icon-squared{background-image:url(flags/1x1/mh.svg)}.flag-icon-mk{background-image:url(flags/4x3/mk.svg)}.flag-icon-mk.flag-icon-squared{background-image:url(flags/1x1/mk.svg)}.flag-icon-ml{background-image:url(flags/4x3/ml.svg)}.flag-icon-ml.flag-icon-squared{background-image:url(flags/1x1/ml.svg)}.flag-icon-mm{background-image:url(flags/4x3/mm.svg)}.flag-icon-mm.flag-icon-squared{background-image:url(flags/1x1/mm.svg)}.flag-icon-mn{background-image:url(flags/4x3/mn.svg)}.flag-icon-mn.flag-icon-squared{background-image:url(flags/1x1/mn.svg)}.flag-icon-mo{background-image:url(flags/4x3/mo.svg)}.flag-icon-mo.flag-icon-squared{background-image:url(flags/1x1/mo.svg)}.flag-icon-mp{background-image:url(flags/4x3/mp.svg)}.flag-icon-mp.flag-icon-squared{background-image:url(flags/1x1/mp.svg)}.flag-icon-mq{background-image:url(flags/4x3/mq.svg)}.flag-icon-mq.flag-icon-squared{background-image:url(flags/1x1/mq.svg)}.flag-icon-mr{background-image:url(flags/4x3/mr.svg)}.flag-icon-mr.flag-icon-squared{background-image:url(flags/1x1/mr.svg)}.flag-icon-ms{background-image:url(flags/4x3/ms.svg)}.flag-icon-ms.flag-icon-squared{background-image:url(flags/1x1/ms.svg)}.flag-icon-mt{background-image:url(flags/4x3/mt.svg)}.flag-icon-mt.flag-icon-squared{background-image:url(flags/1x1/mt.svg)}.flag-icon-mu{background-image:url(flags/4x3/mu.svg)}.flag-icon-mu.flag-icon-squared{background-image:url(flags/1x1/mu.svg)}.flag-icon-mv{background-image:url(flags/4x3/mv.svg)}.flag-icon-mv.flag-icon-squared{background-image:url(flags/1x1/mv.svg)}.flag-icon-mw{background-image:url(flags/4x3/mw.svg)}.flag-icon-mw.flag-icon-squared{background-image:url(flags/1x1/mw.svg)}.flag-icon-mx{background-image:url(flags/4x3/mx.svg)}.flag-icon-mx.flag-icon-squared{background-image:url(flags/1x1/mx.svg)}.flag-icon-my{background-image:url(flags/4x3/my.svg)}.flag-icon-my.flag-icon-squared{background-image:url(flags/1x1/my.svg)}.flag-icon-mz{background-image:url(flags/4x3/mz.svg)}.flag-icon-mz.flag-icon-squared{background-image:url(flags/1x1/mz.svg)}.flag-icon-na{background-image:url(flags/4x3/na.svg)}.flag-icon-na.flag-icon-squared{background-image:url(flags/1x1/na.svg)}.flag-icon-nc{background-image:url(flags/4x3/nc.svg)}.flag-icon-nc.flag-icon-squared{background-image:url(flags/1x1/nc.svg)}.flag-icon-ne{background-image:url(flags/4x3/ne.svg)}.flag-icon-ne.flag-icon-squared{background-image:url(flags/1x1/ne.svg)}.flag-icon-nf{background-image:url(flags/4x3/nf.svg)}.flag-icon-nf.flag-icon-squared{background-image:url(flags/1x1/nf.svg)}.flag-icon-ng{background-image:url(flags/4x3/ng.svg)}.flag-icon-ng.flag-icon-squared{background-image:url(flags/1x1/ng.svg)}.flag-icon-ni{background-image:url(flags/4x3/ni.svg)}.flag-icon-ni.flag-icon-squared{background-image:url(flags/1x1/ni.svg)}.flag-icon-nl{background-image:url(flags/4x3/nl.svg)}.flag-icon-nl.flag-icon-squared{background-image:url(flags/1x1/nl.svg)}.flag-icon-no{background-image:url(flags/4x3/no.svg)}.flag-icon-no.flag-icon-squared{background-image:url(flags/1x1/no.svg)}.flag-icon-np{background-image:url(flags/4x3/np.svg)}.flag-icon-np.flag-icon-squared{background-image:url(flags/1x1/np.svg)}.flag-icon-nr{background-image:url(flags/4x3/nr.svg)}.flag-icon-nr.flag-icon-squared{background-image:url(flags/1x1/nr.svg)}.flag-icon-nu{background-image:url(flags/4x3/nu.svg)}.flag-icon-nu.flag-icon-squared{background-image:url(flags/1x1/nu.svg)}.flag-icon-nz{background-image:url(flags/4x3/nz.svg)}.flag-icon-nz.flag-icon-squared{background-image:url(flags/1x1/nz.svg)}.flag-icon-om{background-image:url(flags/4x3/om.svg)}.flag-icon-om.flag-icon-squared{background-image:url(flags/1x1/om.svg)}.flag-icon-pa{background-image:url(flags/4x3/pa.svg)}.flag-icon-pa.flag-icon-squared{background-image:url(flags/1x1/pa.svg)}.flag-icon-pe{background-image:url(flags/4x3/pe.svg)}.flag-icon-pe.flag-icon-squared{background-image:url(flags/1x1/pe.svg)}.flag-icon-pf{background-image:url(flags/4x3/pf.svg)}.flag-icon-pf.flag-icon-squared{background-image:url(flags/1x1/pf.svg)}.flag-icon-pg{background-image:url(flags/4x3/pg.svg)}.flag-icon-pg.flag-icon-squared{background-image:url(flags/1x1/pg.svg)}.flag-icon-ph{background-image:url(flags/4x3/ph.svg)}.flag-icon-ph.flag-icon-squared{background-image:url(flags/1x1/ph.svg)}.flag-icon-pk{background-image:url(flags/4x3/pk.svg)}.flag-icon-pk.flag-icon-squared{background-image:url(flags/1x1/pk.svg)}.flag-icon-pl{background-image:url(flags/4x3/pl.svg)}.flag-icon-pl.flag-icon-squared{background-image:url(flags/1x1/pl.svg)}.flag-icon-pm{background-image:url(flags/4x3/pm.svg)}.flag-icon-pm.flag-icon-squared{background-image:url(flags/1x1/pm.svg)}.flag-icon-pn{background-image:url(flags/4x3/pn.svg)}.flag-icon-pn.flag-icon-squared{background-image:url(flags/1x1/pn.svg)}.flag-icon-pr{background-image:url(flags/4x3/pr.svg)}.flag-icon-pr.flag-icon-squared{background-image:url(flags/1x1/pr.svg)}.flag-icon-ps{background-image:url(flags/4x3/ps.svg)}.flag-icon-ps.flag-icon-squared{background-image:url(flags/1x1/ps.svg)}.flag-icon-pt{background-image:url(flags/4x3/pt.svg)}.flag-icon-pt.flag-icon-squared{background-image:url(flags/1x1/pt.svg)}.flag-icon-pw{background-image:url(flags/4x3/pw.svg)}.flag-icon-pw.flag-icon-squared{background-image:url(flags/1x1/pw.svg)}.flag-icon-py{background-image:url(flags/4x3/py.svg)}.flag-icon-py.flag-icon-squared{background-image:url(flags/1x1/py.svg)}.flag-icon-qa{background-image:url(flags/4x3/qa.svg)}.flag-icon-qa.flag-icon-squared{background-image:url(flags/1x1/qa.svg)}.flag-icon-re{background-image:url(flags/4x3/re.svg)}.flag-icon-re.flag-icon-squared{background-image:url(flags/1x1/re.svg)}.flag-icon-ro{background-image:url(flags/4x3/ro.svg)}.flag-icon-ro.flag-icon-squared{background-image:url(flags/1x1/ro.svg)}.flag-icon-rs{background-image:url(flags/4x3/rs.svg)}.flag-icon-rs.flag-icon-squared{background-image:url(flags/1x1/rs.svg)}.flag-icon-ru{background-image:url(flags/4x3/ru.svg)}.flag-icon-ru.flag-icon-squared{background-image:url(flags/1x1/ru.svg)}.flag-icon-rw{background-image:url(flags/4x3/rw.svg)}.flag-icon-rw.flag-icon-squared{background-image:url(flags/1x1/rw.svg)}.flag-icon-sa{background-image:url(flags/4x3/sa.svg)}.flag-icon-sa.flag-icon-squared{background-image:url(flags/1x1/sa.svg)}.flag-icon-sb{background-image:url(flags/4x3/sb.svg)}.flag-icon-sb.flag-icon-squared{background-image:url(flags/1x1/sb.svg)}.flag-icon-sc{background-image:url(flags/4x3/sc.svg)}.flag-icon-sc.flag-icon-squared{background-image:url(flags/1x1/sc.svg)}.flag-icon-sd{background-image:url(flags/4x3/sd.svg)}.flag-icon-sd.flag-icon-squared{background-image:url(flags/1x1/sd.svg)}.flag-icon-se{background-image:url(flags/4x3/se.svg)}.flag-icon-se.flag-icon-squared{background-image:url(flags/1x1/se.svg)}.flag-icon-sg{background-image:url(flags/4x3/sg.svg)}.flag-icon-sg.flag-icon-squared{background-image:url(flags/1x1/sg.svg)}.flag-icon-sh{background-image:url(flags/4x3/sh.svg)}.flag-icon-sh.flag-icon-squared{background-image:url(flags/1x1/sh.svg)}.flag-icon-si{background-image:url(flags/4x3/si.svg)}.flag-icon-si.flag-icon-squared{background-image:url(flags/1x1/si.svg)}.flag-icon-sj{background-image:url(flags/4x3/sj.svg)}.flag-icon-sj.flag-icon-squared{background-image:url(flags/1x1/sj.svg)}.flag-icon-sk{background-image:url(flags/4x3/sk.svg)}.flag-icon-sk.flag-icon-squared{background-image:url(flags/1x1/sk.svg)}.flag-icon-sl{background-image:url(flags/4x3/sl.svg)}.flag-icon-sl.flag-icon-squared{background-image:url(flags/1x1/sl.svg)}.flag-icon-sm{background-image:url(flags/4x3/sm.svg)}.flag-icon-sm.flag-icon-squared{background-image:url(flags/1x1/sm.svg)}.flag-icon-sn{background-image:url(flags/4x3/sn.svg)}.flag-icon-sn.flag-icon-squared{background-image:url(flags/1x1/sn.svg)}.flag-icon-so{background-image:url(flags/4x3/so.svg)}.flag-icon-so.flag-icon-squared{background-image:url(flags/1x1/so.svg)}.flag-icon-sr{background-image:url(flags/4x3/sr.svg)}.flag-icon-sr.flag-icon-squared{background-image:url(flags/1x1/sr.svg)}.flag-icon-ss{background-image:url(flags/4x3/ss.svg)}.flag-icon-ss.flag-icon-squared{background-image:url(flags/1x1/ss.svg)}.flag-icon-st{background-image:url(flags/4x3/st.svg)}.flag-icon-st.flag-icon-squared{background-image:url(flags/1x1/st.svg)}.flag-icon-sv{background-image:url(flags/4x3/sv.svg)}.flag-icon-sv.flag-icon-squared{background-image:url(flags/1x1/sv.svg)}.flag-icon-sx{background-image:url(flags/4x3/sx.svg)}.flag-icon-sx.flag-icon-squared{background-image:url(flags/1x1/sx.svg)}.flag-icon-sy{background-image:url(flags/4x3/sy.svg)}.flag-icon-sy.flag-icon-squared{background-image:url(flags/1x1/sy.svg)}.flag-icon-sz{background-image:url(flags/4x3/sz.svg)}.flag-icon-sz.flag-icon-squared{background-image:url(flags/1x1/sz.svg)}.flag-icon-tc{background-image:url(flags/4x3/tc.svg)}.flag-icon-tc.flag-icon-squared{background-image:url(flags/1x1/tc.svg)}.flag-icon-td{background-image:url(flags/4x3/td.svg)}.flag-icon-td.flag-icon-squared{background-image:url(flags/1x1/td.svg)}.flag-icon-tf{background-image:url(flags/4x3/tf.svg)}.flag-icon-tf.flag-icon-squared{background-image:url(flags/1x1/tf.svg)}.flag-icon-tg{background-image:url(flags/4x3/tg.svg)}.flag-icon-tg.flag-icon-squared{background-image:url(flags/1x1/tg.svg)}.flag-icon-th{background-image:url(flags/4x3/th.svg)}.flag-icon-th.flag-icon-squared{background-image:url(flags/1x1/th.svg)}.flag-icon-tj{background-image:url(flags/4x3/tj.svg)}.flag-icon-tj.flag-icon-squared{background-image:url(flags/1x1/tj.svg)}.flag-icon-tk{background-image:url(flags/4x3/tk.svg)}.flag-icon-tk.flag-icon-squared{background-image:url(flags/1x1/tk.svg)}.flag-icon-tl{background-image:url(flags/4x3/tl.svg)}.flag-icon-tl.flag-icon-squared{background-image:url(flags/1x1/tl.svg)}.flag-icon-tm{background-image:url(flags/4x3/tm.svg)}.flag-icon-tm.flag-icon-squared{background-image:url(flags/1x1/tm.svg)}.flag-icon-tn{background-image:url(flags/4x3/tn.svg)}.flag-icon-tn.flag-icon-squared{background-image:url(flags/1x1/tn.svg)}.flag-icon-to{background-image:url(flags/4x3/to.svg)}.flag-icon-to.flag-icon-squared{background-image:url(flags/1x1/to.svg)}.flag-icon-tr{background-image:url(flags/4x3/tr.svg)}.flag-icon-tr.flag-icon-squared{background-image:url(flags/1x1/tr.svg)}.flag-icon-tt{background-image:url(flags/4x3/tt.svg)}.flag-icon-tt.flag-icon-squared{background-image:url(flags/1x1/tt.svg)}.flag-icon-tv{background-image:url(flags/4x3/tv.svg)}.flag-icon-tv.flag-icon-squared{background-image:url(flags/1x1/tv.svg)}.flag-icon-tw{background-image:url(flags/4x3/tw.svg)}.flag-icon-tw.flag-icon-squared{background-image:url(flags/1x1/tw.svg)}.flag-icon-tz{background-image:url(flags/4x3/tz.svg)}.flag-icon-tz.flag-icon-squared{background-image:url(flags/1x1/tz.svg)}.flag-icon-ua{background-image:url(flags/4x3/ua.svg)}.flag-icon-ua.flag-icon-squared{background-image:url(flags/1x1/ua.svg)}.flag-icon-ug{background-image:url(flags/4x3/ug.svg)}.flag-icon-ug.flag-icon-squared{background-image:url(flags/1x1/ug.svg)}.flag-icon-um{background-image:url(flags/4x3/um.svg)}.flag-icon-um.flag-icon-squared{background-image:url(flags/1x1/um.svg)}.flag-icon-us{background-image:url(flags/4x3/us.svg)}.flag-icon-us.flag-icon-squared{background-image:url(flags/1x1/us.svg)}.flag-icon-uy{background-image:url(flags/4x3/uy.svg)}.flag-icon-uy.flag-icon-squared{background-image:url(flags/1x1/uy.svg)}.flag-icon-uz{background-image:url(flags/4x3/uz.svg)}.flag-icon-uz.flag-icon-squared{background-image:url(flags/1x1/uz.svg)}.flag-icon-va{background-image:url(flags/4x3/va.svg)}.flag-icon-va.flag-icon-squared{background-image:url(flags/1x1/va.svg)}.flag-icon-vc{background-image:url(flags/4x3/vc.svg)}.flag-icon-vc.flag-icon-squared{background-image:url(flags/1x1/vc.svg)}.flag-icon-ve{background-image:url(flags/4x3/ve.svg)}.flag-icon-ve.flag-icon-squared{background-image:url(flags/1x1/ve.svg)}.flag-icon-vg{background-image:url(flags/4x3/vg.svg)}.flag-icon-vg.flag-icon-squared{background-image:url(flags/1x1/vg.svg)}.flag-icon-vi{background-image:url(flags/4x3/vi.svg)}.flag-icon-vi.flag-icon-squared{background-image:url(flags/1x1/vi.svg)}.flag-icon-vn{background-image:url(flags/4x3/vn.svg)}.flag-icon-vn.flag-icon-squared{background-image:url(flags/1x1/vn.svg)}.flag-icon-vu{background-image:url(flags/4x3/vu.svg)}.flag-icon-vu.flag-icon-squared{background-image:url(flags/1x1/vu.svg)}.flag-icon-wf{background-image:url(flags/4x3/wf.svg)}.flag-icon-wf.flag-icon-squared{background-image:url(flags/1x1/wf.svg)}.flag-icon-ws{background-image:url(flags/4x3/ws.svg)}.flag-icon-ws.flag-icon-squared{background-image:url(flags/1x1/ws.svg)}.flag-icon-ye{background-image:url(flags/4x3/ye.svg)}.flag-icon-ye.flag-icon-squared{background-image:url(flags/1x1/ye.svg)}.flag-icon-yt{background-image:url(flags/4x3/yt.svg)}.flag-icon-yt.flag-icon-squared{background-image:url(flags/1x1/yt.svg)}.flag-icon-za{background-image:url(flags/4x3/za.svg)}.flag-icon-za.flag-icon-squared{background-image:url(flags/1x1/za.svg)}.flag-icon-zm{background-image:url(flags/4x3/zm.svg)}.flag-icon-zm.flag-icon-squared{background-image:url(flags/1x1/zm.svg)}.flag-icon-zw{background-image:url(flags/4x3/zw.svg)}.flag-icon-zw.flag-icon-squared{background-image:url(flags/1x1/zw.svg)}.flag-icon-eu{background-image:url(flags/4x3/eu.svg)}.flag-icon-eu.flag-icon-squared{background-image:url(flags/1x1/eu.svg)}.flag-icon-gb-eng{background-image:url(flags/4x3/gb-eng.svg)}.flag-icon-gb-eng.flag-icon-squared{background-image:url(flags/1x1/gb-eng.svg)}.flag-icon-gb-nir{background-image:url(flags/4x3/gb-nir.svg)}.flag-icon-gb-nir.flag-icon-squared{background-image:url(flags/1x1/gb-nir.svg)}.flag-icon-gb-sct{background-image:url(flags/4x3/gb-sct.svg)}.flag-icon-gb-sct.flag-icon-squared{background-image:url(flags/1x1/gb-sct.svg)}.flag-icon-gb-wls{background-image:url(flags/4x3/gb-wls.svg)}.flag-icon-gb-wls.flag-icon-squared{background-image:url(flags/1x1/gb-wls.svg)}.flag-icon-un{background-image:url(flags/4x3/un.svg)}.flag-icon-un.flag-icon-squared{background-image:url(flags/1x1/un.svg)}
</style>



<style type="text/css">
/* ----- Common/Page ----- */

body 
{
    background-color:#FFF;
    width:100%;
    height:100%;
    margin:0px;
    padding:0px;
}

body.kuro { background-color:#252525; }

.card_title,
.card_subtitle,
.card_data_table,
.div_placename,
.seed,
.dev_test,
.label,
.item_tag,
.btn,
#alert,
#filter_msg
{
    font-family:-apple-system,BlinkMacSystemFont,Roboto,Helvetica,Arial,sans-serif; /* 'Apple Symbols','Arial Unicode MS' */
}

#alert
{
    width:90%;
    margin:10px 10px;
    padding:10px 10px;
    border-radius:2px;
    border:2px solid #F00;
    color:#000;
    background-color:#FCC;
    text-align:center;
    display:none;
    position:fixed;
    z-index:1000;
    top:-100px;
}

#filter_msg
{
    padding-left:10px;
}

.kuro #filter_msg
{
    color:#FFF;
}

#content
{
    display:flex;
    flex-direction:row;
    flex-wrap:wrap;
    justify-content:center;
    align-items:center;
}


/* ----- Options ----- */

.tbl 
{
    border:0px;
    padding:2px 2px 2px 2px;
    border-collapse:collapse;
    border-spacing: 0px 0px 0px 0px;
}

.label 
{
    font-size:12px; 
    padding-right:5px; 
    color:#000; 
    border:1px solid #666;
}

.kuro .label
{
    color:#888; 
    border:1px solid #666; 
}

.btn
{ 
    margin:10px;
    padding:5px 10px 5px 10px; 
    color:#000;
    background-color:rgba(0,0,0,0.15);
    font-size:12px;
    border:1px solid #444;
    border-radius:4px;
}

.kuro .btn { color:#AAA; }


/* ----- Device Card ----- */

.device_card
{
    width:230px;
    height:129px;
    flex-grow:1;
    margin:5px;
    border:1px solid #DDD;
    border-radius:4px;
    overflow:hidden;
}

.kuro .device_card
{
    border:1px solid #666;
    border-radius:10px;
}

.device_card.nodt              { height: 87px; }
.device_card.nodt.hiddenlines1 { height: 73px; }
.device_card.nodt.hiddenlines2 { height: 59px; }
.device_card.nodt.hiddenlines3 { height: 46px; }
.device_card.tall              { height:409px; }

.device_card.minidt              { height:153px; }
.device_card.minidt.hiddenlines1 { height:145px; }
.device_card.minidt.hiddenlines2 { height:137px; }
.device_card.minidt.hiddenlines3 { height:129px; }

.device_card.minidt.tall              { height:300px; }
.device_card.minidt.tall.hiddenlines1 { height:290px; }
.device_card.minidt.tall.hiddenlines2 { height:280px; }
.device_card.minidt.tall.hiddenlines3 { height:270px; }

.card_rel
{
    position:relative;
    /*
    overflow:hidden;
    */
    width:100%;
    height:100%;
    /*
    border-radius:4px;
    */
}

/*.kuro .card_rel { border-radius:10px; }*/

.card_foreground
{
    position:absolute;
    top:0;
    left:0;
    width:100%;
    height:100%;
    z-index:10;
    overflow-x:hidden;
    overflow-y:auto;
    display:flex;
    flex-direction:row;
    flex-wrap:wrap;
    justify-content:center;
    align-items:flex-start;
    /*
    border-radius:4px;
    */
}

/*
.kuro .card_foreground { border-radius:10px; }
*/

.device_card.minidt .card_foreground,
.device_card.nodt   .card_foreground
{
    overflow-y:hidden;
}

.card_background
{
    position:absolute;
    top:0;
    left:0;
    width:100%;
    height:100%;
    z-index:-100;
    background-color:rgba(255,255,255,1.00);
}

.kuro .card_background { background-color:rgba(102,102,102,1.00); }

.device_card.gradient .card_background       { background-image:linear-gradient(145deg, #EEE, #FFF); }
.kuro .device_card.gradient .card_background { background-image:linear-gradient(145deg, #666, #000); }

.card_flagbkg
{
    width:100%;
    height:100%;
    background-position:50% 50%;
    background-size:cover;
    filter:grayscale(100%);
    opacity:0.05;
}


/* ----- Age Ordinal ----- */

.seed
{
    position:absolute;
    top:0;
    left:0;
    width:23px;
    /*width:15px;*/
    height:14px;
    padding:2px 2px 2px 2px;
    z-index:-9;
    font-size:12px;
    text-align:right;
    color:#BBB;
}

.font_large .seed { font-size:16px; /*width:25px;*/ width:30px; height:18px; }

.kuro .seed
{
    color:rgba(255,255,255,0.5);
    background-color:rgba(255,255,255,0.2);
    border-top-left-radius:10px;
    border-top:1px solid rgba(0,0,0,0.5);
    font-weight:bold;
}

.seed.new0 { color:#000; }
.seed.new1 { color:#BBB; }
.seed.new2 { color:#BBB; }

.kuro .seed.new0 { color:rgba(  0,255,  0,1.0); }
.kuro .seed.new1 { color:rgba( 63,255, 63,0.5); }
.kuro .seed.new2 { color:rgba(192,255,192,0.5); }


/* ----- dev_test indicator ----- */

.dev_test
{
    position:absolute;
    top:0;
    right:0;
    width:23px;
    height:14px;
    padding:2px 2px 2px 2px;
    z-index:-9;
    font-size:12px;
    text-align:left;
    color:#BBB;
}

.font_large .dev_test { font-size:16px; width:30px; height:18px; }

.kuro .dev_test
{
    color:rgba(255,255,255,0.5);
    background-color:rgba(255,255,255,0.2);
    border-top-right-radius:10px;
    border-top:1px solid rgba(0,0,0,0.5);
    font-weight:bold;
}

/* ----- Flag Icon (small, color) ----- */

.place_container
{
    width:50px;
    height:40px;
    text-align:center;
    display:block;
    position:absolute;
    top:1px;
    left:26px;
    z-index:-8;
}

.div_placename
{
    font-size:14px;
    text-align:center;
    vertical-align:middle;
    color:#737373;
}

.kuro .div_placename
{
    text-shadow:0px -1px rgba(0,0,0,0.5);
    color:#EEE;
}

.div_placeflag
{
    text-align:center;
}

.kuro .div_placeflag { filter:drop-shadow(0px -1px 0px rgba(0,0,0,0.5)); }

.card_flagicon
{
    width:30px;
    height:22px;
}


/* ----- Device Card: Title (device_id) ----- */

.card_title_container { width:100%; }

.card_title
{
    width:100%;
    font-size:16px; 
    z-index:10;
    text-align:center;
    margin-top:5px;
    color:#737373;
}

.font_large .card_title { font-size:22px; }

.kuro .card_title
{
    color:#EEE;
    text-shadow:0px 1px rgba(0,0,0,0.5);
}

.card_title.highlight       { color:#000; font-weight:bold; }
.kuro .card_title.highlight { color:#0F0; }

/* ----- Device Card: Subtitle ----- */

.card_subtitle
{
    width:100%;
    font-size:12px;
    text-align:center;
    vertical-align:middle;
    color:#737373;
}

.font_large .card_subtitle { font-size:18px; }

.kuro .card_subtitle { color:#EEE; }

.card_subtitle.err .lastseen_container
{
    display:inline-block;
    padding:0 3px;
    white-space:nowrap;
    /*
    border-radius:0;
    border:0;
    */
    color:#F00;
}

.kuro .card_subtitle.err .lastseen_container
{
    background-color:rgba(63, 0, 0, 0.5);
    border-radius:5px;
    border:1px solid #F00;
}

.card_subtitle.small   { font-size:10px; }
.card_subtitle.smaller { font-size: 8px; padding-bottom:3px; }
.card_subtitle.italic  { font-style:italic; }

.font_large .card_subtitle.small   { font-size:16px; }
.font_large .card_subtitle.smaller { font-size:14px; }

.lastseen_arrow
{
    display:inline-block;
    transform:rotate(90deg);
}

.ttlink
{
    padding-right:5px;
    text-decoration:underline;
    color:#737373;
}

.kuro .ttlink { color:#CCC; }


/* ----- Device Card: Data Table ----- */

.card_data_table_container { margin:5px; }

.card_data_hdr
{
    color:#AAA !important;
    background-color:#252525 !important;
}

.kuro .card_data_hdr
{
    color:#252525 !important;
    background-color:#AAA !important;
}

.card_data_table
{
    font-size:10px;
    color:#444; /* is this used? */
}

.kuro .card_data_table { color:#BBB; }

.card_data_table td
{
    color:#737373;
    border:1px solid #DDD;
}

.kuro .card_data_table td
{
    color:#EEE; 
    border:1px solid #AAA;
    background-color:rgba(0, 0, 0, 0.5);
}

.card_data_table tr > td:not(:first-of-type) { text-align:right; }


/* ----- Device Card: Mini Data "Table" ----- */

.mini_tbl
{
    display:flex;
    flex-direction:row;
    flex-wrap:wrap;
    justify-content:center;
    align-items:center;
}


/* ----- Device Card: Mini Data "Table" Labels/Values ----- */
.item_tag 
{
    font-size:10px;
    font-weight:lighter;
    padding:0 3px;
    margin-bottom:2px;
    white-space:nowrap;
    margin-left:3px;
    text-align:left;
    color:#737373;
    border:1px solid #DDD;
    border-radius:4px;
}


.font_large .item_tag
{
    font-size:16px;
    margin-bottom:4px;
    margin-left:5px;
    border:2px solid #DDD;
}

.kuro .item_tag
{
    color:#EEE; 
    background-color:rgba(0, 0, 0, 0.5);
    border-color:#AAA;
    border-radius:5px;
}

.item_tag.old
{
    color:#E70;
    border-style:dashed;
    border-color:#F84;
}

.item_tag.err
{
    color:#F00;
    border-color:#FBB;
}

.kuro .item_tag.old
{
    border-color:#F80;
    border-style:dashed;
    background-color:rgba(63, 31, 0, 0.5);
}

.kuro .item_tag.err
{
    border-color:#F00;
    background-color:rgba(63, 0, 0, 0.5);
}

.emboss
{
    -webkit-filter: url(#Emboss);
    filter: url(#Emboss);
}




.alertfade {
 -webkit-animation: alertani 5.0s linear 1;
    -moz-animation: alertani 5.0s linear 1;
     -ms-animation: alertani 5.0s linear 1;
      -o-animation: alertani 5.0s linear 1;
         animation: alertani 5.0s linear 1;
}

@keyframes alertani {
   0% { opacity:0; top:-100px; }
  10% { opacity:1; top:   0px; }
  90% { opacity:1; top:   0px; } 
 100% { opacity:0; top:-100px; } }
@-moz-keyframes alertani {
   0% { opacity:0; top:-100px; }
  10% { opacity:1; top:   0px; }
  90% { opacity:1; top:   0px; } 
 100% { opacity:0; top:-100px; } }
@-webkit-keyframes "alertani" {
   0% { opacity:0; top:-100px; }
  10% { opacity:1; top:   0px; }
  90% { opacity:1; top:   0px; } 
 100% { opacity:0; top:-100px; } }
@-ms-keyframes alertani {
   0% { opacity:0; top:-100px; }
  10% { opacity:1; top:   0px; }
  90% { opacity:1; top:   0px; } 
 100% { opacity:0; top:-100px; } }
@-o-keyframes "alertani" {
   0% { opacity:0; top:-100px; }
  10% { opacity:1; top:   0px; }
  90% { opacity:1; top:   0px; } 
 100% { opacity:0; top:-100px; } }
</style>




















<script type="text/javascript">

var _opts = null;

var _opts_defs = {       theme_kuro:false,
                          card_tall:false,
           card_tbl_mini_largerfont:false,
              card_show_age_ordinal:true, 
                 card_show_bkg_flag:true,
                 card_show_bkg_grad:true,
                 card_show_icon_loc:true,
                 card_show_word_txt:false,
                 card_show_devlabel:false,
                 card_show_data_tbl:true,
                 card_show_tbl_mini:false,
                 card_show_tbl_mnew:true,
                 card_show_tbl_hdrs:true,
                 card_show_tooltips:true,
                 card_show_tbl_thrh:true,
                 card_show_tbl_emoj:true,
                 card_show_tbl_egry:false,
                 card_show_tt_links:false,
                   sort_age_ordinal:false,
                           sort_loc:true,
                   filter_pointcast:true,
                   filter_solarcast:false,
                 filter_safecastair:true,
                       filter_nohis:false,
                     filter_olddata:false,
                     filter_devtest:false
            };

var _highlights           = new Array();
var _last_forced_reload   = 0;
var _interval_tsupdate    = null;
var _json                 = null;
var _local_storage_prefix = "INGEST_GRID_";



// ------------------- Device Words Port (from Ray's Go implementation) -------------------

var SortedWords = null;

var Words2048 = ["act","add","age","ago","aim","air","all","and","any","arm","art","ash","ask","bad","bag","ban","bar","bat","bay","bed","bee","beg","bet","bid","big","bit","bow","box","boy","bug","bus","buy","cab","can","cap","car","cat","cop","cow","cry","cue","cup","cut","dad","day","die","dig","dip","dog","dot","dry","due","ear","eat","egg","ego","end","era","etc","eye","fan","far","fat","fee","few","fit","fix",
"fly","fog","for","fun","fur","gap","gas","get","gun","gut","guy","gym","hat","hay","her","hey","him","hip","his","hit","hot","how","hug","huh","ice","its","jar","jaw","jet","job","joy","key","kid","kit","lab","lap","law","leg","let","lid","lie","lip","log","lot","low","mad","man","map","may","mix","mom","mud","net","new","nod","not","now","nut","oak","odd","off","oil","old","one","our","out","owe","own","pad","pan",
"pat","pay","pen","pet","pie","pig","pin","pit","pop","pot","put","rat","raw","red","rib","rid","rip","row","run","say","see","set","she","shy","sir","sit","six","ski","sky","son","spy","sum","sun","tag","tap","tax","tea","ten","the","tie","tip","toe","top","toy","try","two","use","van","war","way","web","who","why","win","wow","yes","yet","you","able","acid","aide","ally","also","amid","area","army","atop","aunt",
"auto","away","baby","back","bake","ball","band","bank","bare","barn","base","bath","beam","bean","bear","beat","beef","beer","bell","belt","bend","best","bias","bike","bill","bind","bird","bite","blue","boat","body","boil","bold","bolt","bomb","bond","bone","book","boom","boot","born","boss","both","bowl","buck","bulb","bulk","bull","burn","bury","bush","busy","cage","cake","call","calm","camp","card","care","cart",
"case","cash","cast","cave","cell","chef","chew","chin","chip","chop","cite","city","clay","clip","club","clue","coal","coat","code","coin","cold","come","cook","cool","cope","copy","cord","core","corn","cost","coup","crew","crop","cure","cute","dare","dark","data","date","dawn","dead","deal","dear","debt","deck","deem","deep","deer","deny","desk","diet","dirt","dish","dock","doll","door","dose","down","drag","draw",
"drop","drug","drum","duck","dumb","dump","dust","duty","each","earn","ease","east","easy","echo","edge","edit","else","even","ever","evil","exam","exit","face","fact","fade","fail","fair","fall","fame","fare","farm","fast","fate","feed","feel","file","fill","film","find","fine","fire","firm","fish","five","flag","flat","flee","flip","flow","fold","folk","food","foot","fork","form","four","free","from","fuel","full",
"fund","gain","game","gang","gate","gaze","gear","gene","gift","girl","give","glad","goal","goat","gold","golf","good","grab","gray","grin","grip","grow","half","hall","hand","hang","hard","harm","hate","haul","have","head","heal","hear","heat","heel","help","herb","here","hero","hers","hide","high","hike","hill","hint","hire","hold","home","hook","hope","horn","host","hour","huge","hunt","hurt","icon","idea","into",
"iron","item","jail","jazz","join","joke","jump","jury","just","keep","kick","kill","kind","king","kiss","knee","know","lack","lake","lamp","land","lane","last","late","lawn","lead","leaf","lean","leap","left","lend","lens","less","life","lift","like","limb","line","link","lion","list","live","load","loan","lock","long","look","loop","loss","lost","lots","loud","love","luck","lung","mail","main","make","mall","many",
"mark","mask","mass","mate","math","meal","mean","meat","meet","melt","menu","mere","mild","milk","mill","mind","mine","miss","mode","mood","moon","more","most","move","much","must","myth","nail","name","near","neat","neck","need","nest","news","next","nice","nine","none","noon","norm","nose","note","odds","okay","once","only","onto","open","ours","oven","over","pace","pack","page","pain","pair","pale","palm","pant",
"park","part","pass","past","path","peak","peel","peer","pick","pile","pill","pine","pink","pipe","plan","play","plea","plot","plus","poem","poet","poke","pole","poll","pond","pool","poor","pork","port","pose","post","pour","pray","pull","pump","pure","push","quit","race","rack","rage","rail","rain","rank","rare","rate","read","real","rear","rely","rent","rest","rice","rich","ride","ring","riot","rise","risk","road",
"rock","role","roll","roof","room","root","rope","rose","ruin","rule","rush","sack","safe","sail","sake","sale","salt","same","sand","save","scan","seal","seat","seed","seek","seem","self","sell","send","sexy","shed","ship","shoe","shop","shot","show","shut","side","sign","silk","sing","sink","site","size","skip","slam","slip","slot","slow","snap","snow","soak","soap","soar","sock","sofa","soft","soil","sole","some",
"song","soon","sort","soul","soup","spin","spit","spot","star","stay","stem","step","stir","stop","such","suck","suit","sure","swim","tail","take","tale","talk","tall","tank","tape","task","team","tear","teen","tell","tend","tent","term","test","text","than","that","them","then","they","thin","this","thus","tide","tile","till","time","tiny","tire","toll","tone","tool","toss","tour","town","trap","tray","tree","trim",
"trip","tube","tuck","tune","turn","twin","type","unit","upon","urge","used","user","vary","vast","very","view","vote","wage","wait","wake","walk","wall","want","warn","wash","wave","weak","wear","weed","week","well","west","what","when","whip","whom","wide","wife","wild","will","wind","wine","wing","wipe","wire","wise","wish","with","wolf","word","work","wrap","yard","yeah","year","yell","your","zone","true","about",
"above","actor","adapt","added","admit","adopt","after","again","agent","agree","ahead","aisle","alarm","album","alien","alike","alive","alley","allow","alone","along","alter","among","angle","ankle","apart","apple","apply","arena","argue","arise","armed","array","arrow","aside","asset","avoid","await","awake","award","aware","basic","beach","beast","begin","being","belly","below","bench","birth","black","blade",
"blame","blank","blast","blend","bless","blind","blink","block","blond","blood","board","boast","bonus","boost","booth","brain","brake","brand","brave","bread","break","brick","bride","brief","bring","broad","brown","brush","buddy","build","bunch","burst","buyer","cabin","cable","candy","cargo","carry","carve","catch","cause","cease","chain","chair","chaos","charm","chart","chase","cheat","check","cheek","cheer",
"chest","chief","child","chill","chunk","claim","class","clean","clear","clerk","click","cliff","climb","cling","clock","close","cloth","cloud","coach","coast","color","couch","could","count","court","cover","crack","craft","crash","crawl","crazy","cream","crime","cross","crowd","cruel","crush","curve","cycle","daily","dance","death","debut","delay","dense","depth","diary","dirty","donor","doubt","dough","dozen",
"draft","drain","drama","dream","dress","dried","drift","drill","drink","drive","drown","drunk","dying","eager","early","earth","eight","elbow","elder","elect","elite","empty","enact","enemy","enjoy","enter","entry","equal","equip","error","essay","event","every","exact","exist","extra","faint","faith","fatal","fault","favor","fence","fever","fewer","fiber","field","fifth","fifty","fight","final","first","fixed",
"flame","flash","fleet","flesh","float","flood","floor","flour","fluid","focus","force","forth","forty","forum","found","frame","fraud","fresh","front","frown","fruit","fully","funny","genre","ghost","giant","given","glass","globe","glory","glove","grace","grade","grain","grand","grant","grape","grasp","grass","grave","great","green","greet","grief","gross","group","guard","guess","guest","guide","guilt","habit",
"happy","harsh","heart","heavy","hello","hence","honey","honor","horse","hotel","house","human","humor","hurry","ideal","image","imply","index","inner","input","irony","issue","jeans","joint","judge","juice","juror","kneel","knife","knock","known","label","labor","large","laser","later","laugh","layer","learn","least","leave","legal","lemon","level","light","limit","liver","lobby","local","logic","loose","lover",
"lower","loyal","lucky","lunch","magic","major","maker","march","match","maybe","mayor","medal","media","merit","metal","meter","midst","might","minor","mixed","model","month","moral","motor","mount","mouse","mouth","movie","music","naked","nasty","naval","nerve","never","newly","night","noise","north","novel","nurse","occur","ocean","offer","often","onion","opera","orbit","order","other","ought","outer","owner",
"paint","panel","panic","paper","party","pasta","patch","pause","phase","phone","photo","piano","piece","pilot","pitch","pizza","place","plain","plant","plate","plead","point","porch","pound","power","press","price","pride","prime","print","prior","prize","proof","proud","prove","pulse","punch","purse","quest","quick","quiet","quite","quote","radar","radio","raise","rally","ranch","range","rapid","ratio","reach",
"react","ready","realm","rebel","refer","relax","reply","rider","ridge","rifle","right","risky","rival","river","robot","round","route","royal","rumor","rural","salad","sales","sauce","scale","scare","scene","scent","scope","score","screw","seize","sense","serve","seven","shade","shake","shall","shame","shape","share","shark","sharp","sheep","sheer","sheet","shelf","shell","shift","shirt","shock","shoot","shore",
"short","shout","shove","shrug","sight","silly","since","sixth","skill","skirt","skull","slave","sleep","slice","slide","slope","small","smart","smell","smile","smoke","snake","sneak","solar","solid","solve","sorry","sound","south","space","spare","spark","speak","speed","spell","spend","spill","spine","spite","split","spoon","sport","spray","squad","stack","staff","stage","stair","stake","stand","stare","start",
"state","steak","steam","steel","steep","steer","stick","stiff","still","stock","stone","store","storm","story","stove","straw","strip","study","stuff","style","sugar","suite","sunny","super","sweat","sweep","sweet","swell","swing","sword","table","taste","teach","thank","their","theme","there","these","thick","thigh","thing","think","third","those","three","throw","thumb","tight","tired","title","today","tooth",
"topic","total","touch","tough","towel","tower","trace","track","trade","trail","train","trait","treat","trend","trial","tribe","trick","troop","truck","truly","trunk","trust","truth","tumor","twice","twist","uncle","under","union","unite","unity","until","upper","upset","urban","usual","valid","value","video","virus","visit","vital","vocal","voice","voter","wagon","waist","waste","watch","water","weave","weigh",
"weird","whale","wheat","wheel","where","which","while","white","whole","whose","widow","woman","works","world","worry","worth","would","wound","wrist","write","wrong","yield","young","yours","youth","false","abroad","absorb","accent","accept","access","accuse","across","action","active","actual","adjust","admire","affect","afford","agency","agenda","almost","always","amount","animal","annual","answer","anyone",
"anyway","appear","around","arrest","arrive","artist","aspect","assert","assess","assign","assist","assume","assure","attach","attack","attend","author","ballot","banana","banker","barrel","basket","battle","beauty","become","before","behalf","behave","behind","belief","belong","beside","better","beyond","bitter","bloody","border","borrow","bottle","bounce","branch","breath","breeze","bridge","bright","broken",
"broker","bronze","brutal","bubble","bucket","bullet","bureau","butter","button","camera","campus","candle","canvas","carbon","career","carpet","carrot","casino","casual","cattle","center","change","charge","cheese","choice","choose","circle","client","clinic","closed","closet","coffee","collar","combat","comedy","commit","comply","cookie","corner","cotton","county","cousin","create","credit","crisis","cruise",
"custom","dancer","danger","deadly","dealer","debate","debris","decade","deeply","defeat","defend","define","degree","depart","depend","depict","deploy","deputy","derive","desert","design","desire","detail","detect","device","devote","differ","dining","dinner","direct","divide","doctor","domain","donate","double","drawer","driver","during","easily","eating","editor","effect","effort","either","eleven","emerge",
"empire","employ","enable","endure","energy","engage","engine","enough","enroll","ensure","entire","entity","equity","escape","estate","evolve","exceed","except","expand","expect","expert","export","expose","extend","extent","fabric","factor","fairly","family","famous","farmer","faster","father","fellow","fierce","figure","filter","finger","finish","firmly","fiscal","flavor","flight","flower","flying","follow",
"forest","forget","formal","format","former","foster","fourth","freely","freeze","friend","frozen","future","galaxy","garage","garden","garlic","gather","gender","genius","gifted","glance","global","golden","ground","growth","guitar","handle","happen","hardly","hazard","health","heaven","height","hidden","highly","hockey","honest","hunger","hungry","hunter","ignore","immune","impact","import","impose","income",
"indeed","infant","inform","injure","injury","inmate","insect","inside","insist","intact","intend","intent","invent","invest","invite","island","itself","jacket","jungle","junior","ladder","lately","latter","launch","lawyer","leader","league","legacy","legend","length","lesson","letter","likely","liquid","listen","little","living","locate","lovely","mainly","makeup","manage","manual","marble","margin","marine",
"market","master","matter","medium","member","memory","mentor","merely","method","middle","minute","mirror","mobile","modern","modest","modify","moment","monkey","mostly","mother","motion","motive","museum","mutter","mutual","myself","narrow","nation","native","nature","nearby","nearly","needle","nobody","normal","notice","notion","number","object","obtain","occupy","office","online","oppose","option","orange",
"origin","others","outfit","outlet","output","oxygen","palace","parade","parent","parish","partly","patent","patrol","patron","pencil","people","pepper","period","permit","person","phrase","pickup","pillow","planet","player","please","plenty","plunge","pocket","poetry","policy","poster","potato","powder","prefer","pretty","priest","profit","prompt","proper","public","purple","pursue","puzzle","rabbit","random",
"rarely","rather","rating","reader","really","reason","recall","recent","recipe","record","reduce","reform","refuse","regain","regard","regime","region","reject","relate","relief","remain","remark","remind","remote","remove","rental","repair","repeat","report","rescue","resign","resist","resort","result","resume","retail","retain","retire","return","reveal","review","reward","rhythm","ribbon","ritual","rocket",
"rubber","ruling","runner","safely","safety","salary","salmon","sample","saving","scared","scheme","school","scream","screen","script","search","season","second","secret","sector","secure","seldom","select","seller","senior","sensor","series","settle","severe","shadow","shorts","should","shrimp","signal","silent","silver","simple","simply","singer","single","sister","sleeve","slight","slowly","smooth","soccer",
"social","sodium","soften","softly","solely","source","speech","sphere","spirit","spread","spring","square","stable","stance","statue","status","steady","strain","streak","stream","street","stress","strict","strike","string","stroke","strong","studio","stupid","submit","subtle","suburb","sudden","suffer","summer","summit","supply","surely","survey","switch","symbol","system","tackle","tactic","talent","target",
"temple","tender","tennis","thanks","theory","thirty","though","thread","thrive","throat","ticket","timber","timing","tissue","toilet","tomato","tongue","toward","tragic","trauma","travel","treaty","tribal","tunnel","turkey","twelve","twenty","unfair","unfold","unique","unless","unlike","update","useful","vacuum","valley","vanish","vendor","verbal","versus","vessel","viewer","virtue","vision","visual","volume",
"voting","wander","warmth","wealth","weapon","weekly","weight","widely","window","winner","winter","wisdom","within","wonder","wooden","worker","writer","yellow"];

var _SortWords = function(src, ref)
{
    src = src.sort(function(a, b) 
    {
        return    ref[a] > ref[b] ?  1
                : ref[a] < ref[b] ? -1 
                : 0;
    });
    
    return src;
};

// Initialize for quick lookup
function WordsInit() 
{
	// Init the index array
	SortedWords = new Uint32Array(2048);
	for (var i=0; i<2048; i++) 
    {
		SortedWords[i] = i;
	}//for

	// Sort the array
    //sort.Sort(ByWord(SortedWords))
    SortedWords = _SortWords(SortedWords, Words2048);
}//WordsInit


function WordsFromNumber(number)
{
	// If the length isn't precisely 2048, this won't work
	if (Words2048.length != 2048) {
		return "not-2048";
	}

    number >>>= 0;

	// Break the 32-bit uint down into 3 parts
	var left   = (number >> 22) & 0x000003ff;
	var middle = (number >> 11) & 0x000007ff;
	var right  =  number        & 0x000007ff;

	// Generate the string
	return Words2048[left] + "-" + Words2048[middle] + "-" + Words2048[right];
}//WordsFromNumber

// Convert a single word to a number
function WordToNumber(what)
{
	//var i = sort.Search(2048, func(i int) bool { return Words2048[SortedWords[i].WordIndex] >= what } )
    var idx = 2049;

    for (var i=0; i<SortedWords.length; i++)
    {
        if (Words2048[SortedWords[i]] >= what)
        {
            idx = i;
            break;
        }//if
    }//for
	
	if (idx < 2048 && Words2048[SortedWords[idx]] == what) 
    {
		return { ok:true, x:SortedWords[idx] };
	}//if

	return { ok:false, x:0 };
}//WordToNumber

// Look up a number from three simple words
function WordsToNumber(what) 
{
	var result = 0 >>> 0;
	
	var word = what.split("-");

	if (word.length != 3) 
    {
		// See if this is just a simple device ID
        var i64 = parseInt(what);
		if (!isNan(i64)) 
        {
			return { ok:true, x:i64 };
		}//if

		return { ok:false, x:0 };
	}//if

    var a;

    a = WordToNumber(word[0]);
    var left = a.x;

	if (!a.ok) 
    {
		return { ok:false, x:0 };
	}//if

	a = WordToNumber(word[1]);
    var middle = a.x;

	if (!a.ok) 
    {
		return { ok:false, x:0 };
	}//if

	a = WordToNumber(word[2]);
    var right = a.x;

	if (!a.ok) 
    {
		return { ok:false, x:0 };
	}//if

	result |= ((left  )>>>0) << 22;
	result |= ((middle)>>>0) << 11;
	result |= ((right )>>>0);

	return { ok:true, x:result };
}//WordsToNumber











var _GetAsync_HTTP = function(url, responseType, responseHeader, fxCallback, userData)
{
    var req = new XMLHttpRequest();
    req.open("GET", url, true);

    if (responseType != null)
    {
        if (responseType == "text\/plain; charset=x-user-defined") req.overrideMimeType(responseType);
        else req.responseType = responseType;    //"arraybuffer", "blob", "document", "json", and "text"        
    }//if
    
    req.onreadystatechange = function () // why was this ==== ?
    {
        if (req.readyState === 4 && req.status == 200 && req.response != null)
        {
            fxCallback(responseHeader != null ? eq.getResponseHeader(responseHeader) : req.response, userData);
        }//if
        else if (req.readyState === 4)
        {
            // This attemps to trap Chrome's ERR_NETWORK_CHANGED
            // and other network failures which cause the updates to stop.
            console.log("_GetAsync_HTTP: req.readyState == 4, req.status == %d.  Retrying.", req.status);
            fxCallback(null, userData);
        }//else if
    };
    
    req.send(null);
};


var GetJSONAsync = function(url)
{
    var ss_now      = "" + (parseInt(Date.now() * 0.001));
    var url_nocache = url + "?t=" + ss_now;
    
    var cb = function(response, userData)
    {
        var success = response != null && response.length > 0;

        if (success)
        {
            var obj = null;
            try         { obj = JSON.parse(response); }
            catch (err) { console.log("GetJSONAsync: JSON parsing exception."); }
            
            if   (obj != null) AddOrUpdateJson(obj);
            else               success = false;
        }//if
    
        if (!success)
        {
            console.log("GetJSONAsync: Error getting sensors from URL: %s", url);
        }//if

        var after_ms = (success ? 60 : 600) * 1000; // 1 min normally, 10 mins on failure

        setTimeout(function() {
            this.last_tx = Date.now();
            this.GetJSONAsync(url);
        }.bind(this), after_ms);
    }.bind(this);

    _GetAsync_HTTP(url_nocache, null, null, cb, null);
};

function IsOld(dev_node)
{
    var thr = Date.now() - 86400.0 * 1000.0;
    var d   = false;

    for (var i=0; i<dev_node.units.length; i++)
    {
        if (Date.parse(dev_node.units[i].stats.max_ts) > thr)
        {
            d = true;
            break;
        }//if
    }//for

    return !d;
}//IsOld

function IsOldDeviceId(device_id)
{
    var d = false;

    for (var i=0; i<_json.length; i++)
    {
        if (_json[i].device_id == device_id)
        {
            d = IsOld(_json[i]);
            break;
        }//if
    }//for

    return d;
}//IsOldDeviceId

function IsOfflineUnit(unit_node, is_scope_device)
{
    return Date.parse(unit_node.stats.max_ts) < Date.now() - 1.5 * (!is_scope_device && unit_node.unit.indexOf("dev_") > -1 ? 4.0 : 1.0) * 60.0 * 60.0 * 1000.0;
}//IsOfflineUnit

function IsOffline(dev_node)
{
    var thr = Date.now() - 90.0 * 60.0 * 1000.0;
    var d   = false;

    for (var i=0; i<dev_node.units.length; i++)
    {
        /*
        if (Date.parse(dev_node.units[i].stats.max_ts) > thr)
        {
            d = true;
            break;
        }//if
        */
        if (!IsOfflineUnit(dev_node.units[i], true))
        {
            d = true;
            break;
        }//if
    }//for

    return !d;
}//IsOffline

function GetLatLon(dev_node)
{
    var lat_val = null;
    var lon_val = null;

    for (var i=0; i<dev_node.units.length; i++)
    {
        if (dev_node.units[i].unit == "loc_lat") lat_val = dev_node.units[i].stats.val;
        if (dev_node.units[i].unit == "loc_lon") lon_val = dev_node.units[i].stats.val;        
        if (lat_val != null && lon_val != null)  break;
    }//for

    return { y:lat_val, x:lon_val };
}//GetLatLon

function IsGpsErr(dev_node)
{
    var yx = GetLatLon(dev_node);
    var d  = false;

    if (    yx.x != null   && yx.y !=  null
        &&  yx.y >=  -90.0 && yx.y <=  90.0
        &&  yx.x >= -180.0 && yx.x <= 180.0
        && (yx.y < -1.0 || yx.y > 1.0 || yx.x < -1.0 || yx.x > 1.0))
    {
        d = true;
    }//if

    return !d;
}//IsGpsErr

function GetPlaceName(dev_node)
{
    var d  = null;
    var yx = GetLatLon(dev_node);
    return yx.x == null || yx.y == null ? null : GetPlaceNameForLatLon(yx.y, yx.x);
}//GetPlaceName

function GetLastSeenTimeMS(dev_node)
{
    var t = 0;

    for (var i=0; i<dev_node.units.length; i++)
    {
        var d = Date.parse(dev_node.units[i].stats.max_ts);
        if (d > t) t = d;
    }//for

    return t;
}//GetLastSeenTimeMS

function GetOldestTimeMS(dev_node)
{
    var t = Date.now()*2.0;

    for (var i=0; i<dev_node.units.length; i++)
    {
        var d = Date.parse(dev_node.units[i].stats.min_ts);
        if (d < t) t = d;
    }//for

    return t;
}//GetOldestTimeMS

function GetSumCountForGroup(dev_node, group)
{
    var n = 0;

    for (var i=0; i<dev_node.units.length; i++)
    {
        var unit_info = GetUnitInfo(dev_node.units[i].unit);

        if (unit_info.group == group)
        {
            n += dev_node.units[i].stats.n;
        }//if
    }//for

    return n;
}//GetSumCountForGroup

function _ToFixedIfShorter(x, n)
{
    var tf = x.toFixed(n);
    var ts = "" + x;
    return tf.length < ts.length ? tf : ts;
}//_ToFixedIfShorter

function _ToFixedIfShorterSig(x, n)
{
    if (Math.abs(x) > 1.0)
    {
        n -= Math.trunc(Math.abs(x)).toString().length;
    }//if
    else if (Math.abs(x) < 1.0 / Math.pow(10.0, n) / 2.0)
    {
        n = 0;
    }//else if

    if (n < 0) n = 0;

    //if (n > 2 && parseFloat(x.toFixed(n)) == parseFloat(x.toFixed(n-1))) n--;
    //if (n > 1 && parseFloat(x.toFixed(n)) == parseFloat(x.toFixed(n-1))) n--;
    //if (n > 0 && parseFloat(x.toFixed(n)) == parseFloat(x.toFixed(0  ))) n = 0;

    var tf = x.toFixed(n);
    var ts = "" + x;
    return tf.length < ts.length ? tf : ts;
}//_ToFixedIfShorterSig

function IsOldUnit(unit_node)
{
    var thr = Date.now() - 86400.0 * 1000.0;
    var d = false;

    if (Date.parse(unit_node.stats.max_ts) > thr)
    {
        d = true;
    }//if

    return !d;
}//IsOldUnit

function GetEmojiSetNameForGlyph(g, is_gray)
{
    var d = "twitter";
    var a = [ { g:"radioactive_sign", m:null,  s:"android"  },
              { g:"thermometer",      m:null,  s:"twitter"  },
              { g:"microscope",       m:null,  s:"twitter"  },
              { g:"earth_asia",       m:null,  s:"android"  },
              { g:"battery",          m:null,  s:"emojione" },
              { g:"one",              m:true,  s:"twitter"  },
              { g:"one",              m:false, s:"apple"    },
              { g:"two",              m:true,  s:"twitter"  },
              { g:"two",              m:false, s:"apple"    },
              { g:"keycap_ten",       m:true,  s:"twitter"  },
              { g:"keycap_ten",       m:false, s:"apple"    } ];

    for (var i=0; i<a.length; i++)
    {
        if (a[i].g == g && (a[i].m == null || a[i].m == is_gray))
        {
            d = a[i].s;
            break;
        }//if
    }//for

    return d;
}//GetEmojiSetNameForGlyph

function NewFullDataTableForDeviceCard(dev_node)
{
    var tbl       = document.createElement("table");
    tbl.className = "card_data_table";

    if (_opts.card_show_tbl_hdrs)
    {
        var tr_hdr    = tbl.insertRow(-1);
        var td0       = tr_hdr.insertCell(-1);
        var td1       = tr_hdr.insertCell(-1);
        var td2       = tr_hdr.insertCell(-1);
        var td3       = tr_hdr.insertCell(-1);
        var td4       = tr_hdr.insertCell(-1);
        td0.className = "card_data_hdr";
        td0.innerHTML = "Unit";
        td1.innerHTML = "n";
        td1.className = "card_data_hdr";
        td2.innerHTML = "Min";
        td2.className = "card_data_hdr";
        td3.innerHTML = "Max";
        td3.className = "card_data_hdr";
        td4.innerHTML = "Newest";
        td4.className = "card_data_hdr";
    }//if

    for (var i=0; i<dev_node.units.length; i++)
    {
        if ((   _opts["card_show_tbl_" + dev_node.units[i].unit] == null
             || _opts["card_show_tbl_" + dev_node.units[i].unit])
            && (!_opts.filter_olddata || !IsOldUnit(dev_node.units[i])))
        {
            var unit_info      = GetUnitInfo(dev_node.units[i].unit);
            var grp_info       = GetGroupInfo(unit_info.group);
            var tr             = tbl.insertRow(-1);
            var td_title       = tr.insertCell(-1);
            var td_n           = tr.insertCell(-1);
            var td_min         = tr.insertCell(-1);
            var td_max         = tr.insertCell(-1);
            var td_last        = tr.insertCell(-1);
            //td_title.innerHTML = (_opts.card_show_tbl_emoj ? (grp_info.emoji + "&nbsp;") : "") + dev_node.units[i].unit;
            if (!_opts.card_show_tbl_emoj)
            {
                td_title.innerHTML = dev_node.units[i].unit;
            }//if
            else
            {
                var ts = document.createElement("span");
                ts.style.paddingLeft = "1px";
                ts.innerHTML = dev_node.units[i].unit;

                var emc = document.createElement("div");
                emc.className = "ap-container";

                var em = document.createElement("div");
                em.className = "ap"
                             + (_opts.card_show_tbl_egry ? " gray" : "")
                             + " ap-" + unit_info.min_ic
                             + " " + GetEmojiSetNameForGlyph(unit_info.min_ic, _opts.card_show_tbl_egry);

                td_title.appendChild(emc);
                emc.appendChild(em);
                td_title.appendChild(ts);
            }//else

            td_n.innerHTML     = "" + _ToFixedIfShorter(dev_node.units[i].stats.n, unit_info.decs);
            td_min.innerHTML   = "" + _ToFixedIfShorter(dev_node.units[i].stats.min, unit_info.decs);
            td_max.innerHTML   = "" + _ToFixedIfShorter(dev_node.units[i].stats.max, unit_info.decs);
            td_last.innerHTML  = "" + _ToFixedIfShorter(dev_node.units[i].stats.val, unit_info.decs);
        }//if
    }//for

    return tbl;
}//NewFullDataTableForDeviceCard


function NewMiniDataTableForDeviceCard(dev_node)
{
    var div        = document.createElement("div");
    div.className  = "mini_tbl";
    var last_group = -1;
    var span       = null;

    for (var i=0; i<dev_node.units.length; i++)
    {
        var unit_info = GetUnitInfo(dev_node.units[i].unit);

        if (unit_info.group != last_group
            && (   _opts["card_show_tbl_" + dev_node.units[i].unit] == null
                || _opts["card_show_tbl_" + dev_node.units[i].unit])
            && (!_opts.filter_olddata || !IsOldUnit(dev_node.units[i]))
           )
        {
            span = document.createElement("div");
            div.appendChild(span);

            span.className = "item_tag";
            span.innerHTML = (_opts.card_show_tbl_emoj ? (GetGroupInfo(unit_info.group).emoji + "&nbsp;") : "")
                           + GetGroupInfo(unit_info.group).title 
                           + ": " 
                           + GetSumCountForGroup(dev_node, unit_info.group);

            last_group = unit_info.group;
        }//if
    }//for

    return div;
}//NewMiniDataTableForDeviceCard

function NewMiniNewestDataTableForDeviceCard(dev_node)
{
    var div       = document.createElement("div");
    div.className = "mini_tbl";

    for (var i=0; i<dev_node.units.length; i++)
    {
        var unit_info = GetUnitInfo(dev_node.units[i].unit);

        if ((   _opts["card_show_tbl_" + dev_node.units[i].unit] == null
             || _opts["card_show_tbl_" + dev_node.units[i].unit])
            && (!_opts.filter_olddata || !IsOldUnit(dev_node.units[i]))  
           )
        {
            var el         = document.createElement("div");
            var val        = (dev_node.units[i].unit == "env_press" || dev_node.units[i].unit == "dev_press" ? dev_node.units[i].stats.val / 10.0 : dev_node.units[i].stats.val);  // hack: hPa -> KPa for more compact display
            var xs         = _ToFixedIfShorterSig(val, unit_info.decs);
            var t;
            el.className   = "item_tag tooltip narrow up" + (_opts.card_show_tbl_thrh && IsOorForUnit(val, dev_node.units[i].unit) ? " err" : "")
                                                          + (_opts.card_show_tbl_thrh && !IsOffline(dev_node) && IsOfflineUnit(dev_node.units[i]) ? " old" : "");
            
            if (_opts.card_show_tbl_emoj)
            {
                t = ""+xs + (unit_info.min_suffix != null ? unit_info.min_suffix : "");

                var ts = document.createElement("div");
                ts.className = "ap-label";
                ts.innerHTML = t;
                //el.innerHTML = t;

                var emc = document.createElement("div");
                emc.className = "ap-container";

                var em = document.createElement("div");
                em.className = "ap"
                             + (_opts.card_show_tbl_egry ? " gray" : "")
                             + " ap-" + unit_info.min_ic
                             + " " + GetEmojiSetNameForGlyph(unit_info.min_ic, _opts.card_show_tbl_egry);

                /*
                if (unit_info.min_ic == "battery")
                {
                    em.className = "fa fa-battery-full";
                    emc.className = "fa-container";
                }//if

                if (unit_info.min_ic == "thermometer")
                {
                    em.className = "fa fa-thermometer-full";
                    emc.className = "fa-container";
                }//if

                if (unit_info.min_ic == "microscope")
                {
                    em.className = "fa fa-thermometer-empty";
                    emc.className = "fa-container";
                }//if
                */

                /*
                if (unit_info.min_ic == "one")
                {
                    em.className = "ap ap-one twitter";
                }//if

                if (unit_info.min_ic == "two")
                {
                    em.className = "ap ap-two twitter";
                }//if

                if (unit_info.min_ic == "keycap_ten")
                {
                    em.className = "ap ap-keycap_ten twitter";
                }//if
                */

                el.appendChild(emc);
                emc.appendChild(em);
                el.appendChild(ts);
            }//if
            else
            {
                t = dev_node.units[i].unit + ": " + xs;
                el.innerHTML = t;
            }//else

            /*
            if (_opts.card_show_tbl_emoj)
            {
                t = ""+unit_info.st;
                t = t.replace(/{x}/g, ""+xs);
            }//if
            else
            {
                t = dev_node.units[i].unit + ": " + xs;
            }//else

            el.innerHTML = t;
            */

            if (_opts.card_show_tooltips)
            {
                var tt       = document.createElement("span");
                tt.className = "tooltiptext";

                var ett      = null;

                if (_opts.card_show_tbl_thrh && !IsOffline(dev_node) && IsOfflineUnit(dev_node.units[i]))
                {
                    ett = _GetElapsedTimeText((Date.parse(dev_node.units[i].stats.max_ts)/1000.0)>>>0);
                }//if

                tt.innerHTML = dev_node.units[i].unit 
                             + "<br/>" + (unit_info.si == "hPa" ? "kPa" : unit_info.si)
                             + (ett != null ? "<br/>" + ett.value + " " + ett.text + " ago" : "");
                el.appendChild(tt);
            }//if

            div.appendChild(el);
        }//if
    }//for

    return div;
}//NewMiniNewestDataTableForDeviceCard






var _GetTtDeviceLogUrl    = function(device_id) { return "http://tt.safecast.org/device-log/" + (new Date()).getFullYear() + "-" + _Pad2((new Date()).getMonth() + 1) + "-" + device_id + ".json"; };
var _GetTtDeviceChkUrl    = function(device_id) { return "http://tt.safecast.org/check/"  + device_id; };
var _GetTtDeviceUrl       = function(device_id) { return "http://tt.safecast.org/device/" + device_id; };
var _GetTtDeviceLinksHtml = function(device_id) {
    return   "<a href='" +    _GetTtDeviceUrl(device_id) + "' target='_blank' class='ttlink'>" + "dev" + "</a>"
           + "<a href='" + _GetTtDeviceChkUrl(device_id) + "' target='_blank' class='ttlink'>" + "chk" + "</a>"
           + "<a href='" + _GetTtDeviceLogUrl(device_id) + "' target='_blank' class='ttlink'>" + "log" + "</a>"; };


function GetNewCardTitleLastSeedDiv(dev_node)
{
    var d       = document.createElement("div");
    d.id        = "lastseen_" + dev_node.device_id;
    d.className = "card_subtitle";
    return d;
}//GetNewCardTitleLastSeedDiv

function GetNewCardTitleTtLinksDiv(dev_node)
{
    var d       = document.createElement("div");
    d.innerHTML = _GetTtDeviceLinksHtml(dev_node.device_id);
    d.className = "card_subtitle smaller";
    return d;
}//GetNewCardTitleTtLinksDiv

function GetNewCardTitleDevLabelDiv(dev_node)
{
    var d       = document.createElement("div");
    d.innerHTML = dev_node.dev_label != null ? "&quot;" + dev_node.dev_label + "&quot;" : "&nbsp;";
    d.className = "card_subtitle";
    return d;
}//GetNewCardTitleDevLabelDiv

function GetNewCardTitleDevWordsDiv(dev_node, wordsforid)
{
    var d       = document.createElement("div");
    d.innerHTML = wordsforid;
    d.className = "card_subtitle italic";
    return d;
}//GetNewCardTitleDevWordsDiv

function GetNewCardTitleTooltipSpan(dev_node, pn, wordsforid)
{
    var tt       = document.createElement("span");
    var txts     = new Array();
    var txt      = "";
    var c        = 0;
    tt.className = "tooltiptext";
    
    txts.push(!_opts.card_show_word_txt ? wordsforid : "");
    txts.push(!_opts.card_show_devlabel && dev_node.dev_label != null ? "&quot;" + dev_node.dev_label + "&quot;" : "");
    txts.push(pn != null && pn.name != null ? pn.name : "");

    for (var i=0; i<txts.length; i++)
    {
        if (txts[i].length > 0)
        {
            if (c > 0) txt += "<br/>";
            txt += txts[i];
            c++;
        }//if
    }//for

    tt.innerHTML = txt;
    return tt;
}//GetNewCardTitleTooltipSpan

function GetNewCardTitleDiv(dev_node, pn, wordsforid)
{
    var d       = document.createElement("div");
    d.innerHTML = "" + dev_node.device_id;
    d.value     = "" + dev_node.device_id;
    d.className = "card_title tooltip wide down";
    
    if (_opts.card_show_tooltips)
    {
        var tt = GetNewCardTitleTooltipSpan(dev_node, pn, wordsforid);
        d.appendChild(tt);
    }//if
    
    if (!_opts.filter_nohis)
    {
        d.addEventListener("click", function(e) 
        {
            AddNameToHighlights(this.value);
            this.className = this.className.indexOf("highlight") > -1 ? this.className.replace(/highlight/, "") : this.className + " highlight";
            //e.stopPropagation(); 
        }.bind(d), false);
    }//if

    if (IsHighlight(dev_node.device_id)) d.className += " highlight";

    return d;
}//GetNewCardTitleDiv


function GetNewCardTitleGroup(dev_node, pn)
{
    var title_container       = document.createElement("div");
    var wordsforid            = WordsFromNumber(dev_node.device_id);
    title_container.className = "card_title_container";

    var title_div = GetNewCardTitleDiv(dev_node, pn, wordsforid);
    title_container.appendChild(title_div);

    if (_opts.card_show_tt_links)
    {
        var links_div = GetNewCardTitleTtLinksDiv(dev_node);
        title_container.appendChild(links_div);
    }//if

    if (_opts.card_show_devlabel)
    {
        var label_div = GetNewCardTitleDevLabelDiv(dev_node);
        title_container.appendChild(label_div);
    }//if

    if (_opts.card_show_word_txt)
    {
        var words_div = GetNewCardTitleDevWordsDiv(dev_node, wordsforid);
        title_container.appendChild(words_div);
    }//if

    var last_seen_div = GetNewCardTitleLastSeedDiv(dev_node);
    title_container.appendChild(last_seen_div);

    return title_container;
}//GetNewCardTitle



function GetNewCardAgeOrdinalDiv(dev_node)
{
    var oldest_ms  = GetOldestTimeMS(dev_node);
    var age_idx    = dev_node.device_age_ordinal;
    var seed       = document.createElement("div");
    seed.className = "seed";
    seed.innerHTML = "" + (age_idx + 1);

         if (Date.now() - oldest_ms < 86400.0 * 2.0 * 1000.0) seed.className += " new0";
    else if (Date.now() - oldest_ms < 86400.0 * 3.0 * 1000.0) seed.className += " new1";
    else if (Date.now() - oldest_ms < 86400.0 * 4.0 * 1000.0) seed.className += " new2";

    return seed;
}//GetNewCardAgeOrdinalDiv



function GetNewCardDevTestDiv(dev_node)
{
    var d = document.createElement("div");
    d.className = "dev_test";
    d.innerHTML = "DEV";
    return d;
}//GetNewCardDevTestDiv



function GetNewCardFlagIconDiv(dev_node, pn)
{
    var d = null;

    if (pn != null && pn.fs != null)
    {
        d           = document.createElement("div");
        var f       = document.createElement("span");
        d.className = "div_placeflag";
        f.className = "card_flagicon flag-icon flag-icon-background flag-icon-" + (pn.fs == "xx" ? "un" : pn.fs);
        d.appendChild(f);
    }//if

    return d;
}//GetNewCardFlagIconDiv

function GetNewCardFlagNameDiv(dev_node, pn)
{
    var d = null;

    if (pn != null && pn.detail_for_flag != null)
    {
        d           = document.createElement("div");
        d.className = "div_placename";
        d.innerHTML = pn.detail_for_flag;
    }//if

    return d;
}//GetNewCardFlagNameDiv

function AdjustCardHeightByClassForSubheaders(c)
{
    var hidden_lines = (_opts.card_show_word_txt ? 0 : 1) 
                     + (_opts.card_show_devlabel ? 0 : 1) 
                     + (_opts.card_show_tt_links ? 0 : 1);
    c.className = c.className.replace(/hiddenlines1/, "");
    c.className = c.className.replace(/hiddenlines2/, "");
    c.className = c.className.replace(/hiddenlines3/, "");
    if (hidden_lines > 0) c.className += " hiddenlines" + hidden_lines;
}//AdjustCardHeightByClassForSubheaders

function AddDeviceCardToContainer(container, dev_node)
{
    var is_offline = IsOffline(dev_node);
    var gps_err    = IsGpsErr(dev_node);
    var pn         = GetPlaceName(dev_node);

    var c_rel = document.createElement("div");
    var f_abs = document.createElement("div");
    var b_abs = document.createElement("div");

    c_rel.className = "card_rel";
    f_abs.className = "card_foreground";
    b_abs.className = "card_background";
    b_abs.id        = "bkg_" + dev_node.device_id;
    container.appendChild(c_rel);
    c_rel.appendChild(b_abs);
    c_rel.appendChild(f_abs);

    if (!gps_err && pn != null && _opts.card_show_bkg_flag)
    {
        var fc = document.createElement("div");
        b_abs.appendChild(fc);
        fc.className = "card_flagbkg flag-icon flag-icon-background flag-icon-" + (pn.fs == "xx" ? "un" : pn.fs);
    }//if

    if (!gps_err && _opts.card_show_icon_loc)
    {
        var pf_div = GetNewCardFlagIconDiv(dev_node, pn);
        var pn_div = GetNewCardFlagNameDiv(dev_node, pn);

        if (pf_div != null) 
        {
            var pc_div = document.createElement("div");
            pc_div.className = "place_container";
            pc_div.appendChild(pf_div);
            f_abs.appendChild(pc_div);
            if (pn_div != null) pc_div.appendChild(pn_div);
        }//if        
    }//if

    var title_container = GetNewCardTitleGroup(dev_node, pn);
    f_abs.appendChild(title_container);

    if (_opts.card_show_data_tbl)
    {
        var dt_div       = document.createElement("div");
        dt_div.className = "card_data_table_container";
        var tbl          = _opts.card_show_tbl_mnew ? NewMiniNewestDataTableForDeviceCard(dev_node)
                         : _opts.card_show_tbl_mini ? NewMiniDataTableForDeviceCard(dev_node)
                         :                            NewFullDataTableForDeviceCard(dev_node);
        f_abs.appendChild(dt_div);
        dt_div.appendChild(tbl);
    }//if

    if (_opts.card_show_age_ordinal)
    {
        var seed = GetNewCardAgeOrdinalDiv(dev_node);
        //c_rel.appendChild(seed);
        f_abs.appendChild(seed);
    }//if


    if (dev_node.dev_test.toLowerCase() == "true")
    {
        var devtest = GetNewCardDevTestDiv(dev_node);
        f_abs.appendChild(devtest);
    }//if


    AdjustCardHeightByClassForSubheaders(container);

    if (_opts.card_show_data_tbl && _opts.card_show_tbl_mnew && _opts.card_show_tbl_emoj && container.className.indexOf("minidt") < 0)
    {
        container.className += " minidt";
    }//if

    if (!_opts.card_show_data_tbl && container.className.indexOf("nodt") < 0)
    {
        container.className += " nodt";
    }//if

    if (_opts.card_tall && container.className.indexOf("tall") < 0)
    {
        container.className += " tall";
    }//if

    if (_opts.card_tbl_mini_largerfont && container.className.indexOf("font_large") < 0)
    {
        container.className += " font_large";
    }//if

    if (_opts.card_show_bkg_grad && container.className.indexOf("gradient") < 0)
    {
        container.className += " gradient";
    }//if
}//AddDeviceCardToContainer



function NewDeviceCardContainer(dev_node)
{
    var d       = document.createElement("div");
    d.className = "device_card";
    d.id        = "dev_" + dev_node.device_id;
    return d;
}//NewDeviceCardContainer

function ClearDeviceCard(container)
{
    while (container.firstChild) { container.removeChild(container.firstChild); }//while
}//ClearDeviceCard

function CreateOrUpdateDeviceCard(dev_node, content)
{
    var cards    = content == null ?  null : content.getElementsByClassName("device_card");
    var card     = null;
    var had_card = false;

    if (cards != null)
    {
        for (var i=0; i<cards.length; i++)
        {
            if (cards[i].id == "dev_" + dev_node.device_id)
            {
                card = cards[i];
                had_card = true;
                ClearDeviceCard(card);
                break;
            }//if
        }//for
    }//if

    if (card == null) card = NewDeviceCardContainer(dev_node);

    AddDeviceCardToContainer(card, dev_node);

    if (!had_card) content.appendChild(card);
}//CreateOrUpdateDeviceCard


function SortJson(o)
{
    o =   _opts.sort_age_ordinal ? _SortJsonByDeviceAgeOrdinal(o) 
        : _opts.sort_loc         ? _SortJsonByLoc(o)
        :                          _SortJsonByDeviceId(o);

    for (var i=0; i<o.length; i++)
    {
        o[i].units = _SortUnitsByUnit(o[i].units);
    }//for

    return o;
}//SortJson

function IsDevicePointcast(device_id)
{
    return (device_id >=      0 && device_id <=  29999)
        || (device_id >= 100000 && device_id <= 199999);
}//IsDevicePointcast

function IsDeviceSafecastAir(device_id)
{
    return (device_id >=  50000 && device_id <=  59999);
}//IsDeviceSafecastAir

function IsDeviceSolarcast(device_id)
{
    return device_id > 199999;
}//IsDeviceSolarcast

function IsDevTest(device_id)
{
    var d = false;

    for (var i=0; i<_json.length; i++)
    {
        if (_json[i].device_id == device_id)
        {
            d = _json[i].dev_test.toLowerCase() == 'true';
        }//if
    }//for

    return d;
}//IsDevTest

function ShouldShowDevice(device_id)
{
    return    (!_opts.filter_pointcast  || !IsDevicePointcast(device_id))
           && (!_opts.filter_safecastair|| !IsDeviceSafecastAir(device_id))
           && (!_opts.filter_solarcast  || !IsDeviceSolarcast(device_id))
           && (!_opts.filter_nohis      ||  IsHighlight(device_id))
           && (!_opts.filter_olddata    || !IsOldDeviceId(device_id))
           && (!_opts.filter_devtest    || !IsDevTest(device_id));
}//ShouldShowDevice

function AddOrUpdateJson(o)
{
    var old_len = _json != null ? _json.length : 0;
    _json = o;
    JsonCpmToUsvh();
    AddDeviceAgeOrdinalToJson();
    AddLocSortStringToJson();
    _json = SortJson(_json);

    var c = 0;

    // Currently the following are not handled with the incremental updates:
    // 1. New devices being sorted properly
    // 2. Changes to age ordinal / icon URLs that would occur from the normal passage of time
    // Thus, every hour or when a new device is detected, a full update is performed.

    if (Date.now() - _last_forced_reload > 60.0 * 60.0 * 1000.0
        || old_len != _json.length)
    {
        _last_forced_reload = Date.now();
        ClearAllContent();
    }//if

    if (_opts.theme_kuro && document.body.className.indexOf("kuro") < 0)
    {
        document.body.className += " kuro";
    }//if
    else if (!_opts.theme_kuro && document.body.className.indexOf("kuro") >= 0)
    {
        document.body.className = document.body.className.replace(/kuro/, "");
    }//else if

    var content = document.getElementById("content");
    
    for (var i=0; i<_json.length; i++)
    {
        if (ShouldShowDevice(_json[i].device_id))
        {
            if (GetHasChangedCard(_json[i])) CreateOrUpdateDeviceCard(_json[i], content);

            UpdateLastSeen(_json[i]);

            c++;
        }//if
    }//for

    var f = document.getElementById("filter_msg");

    f.innerHTML = "Displaying " + c + "/" + _json.length + " devices." + (c != _json.length ? " (filtered)" : "");

    UpdateQueryString();
}//AddOrUpdateJson

function UpdateQueryString()
{
    var qs = GetQueryStringForOptions();
    var url = (window.location.href.indexOf("?") > -1 ? window.location.href.split("?")[0] : window.location.href) + qs;
    history.pushState(null, null, url);
}//UpdateQueryString

function GetHasChangedCard(dev_node)
{
    var el = document.getElementById("lastseen_" + dev_node.device_id);

    if (el == null) return true;

    var last_ms = GetLastSeenTimeMS(dev_node);
    var ts_txt  = _GetDateTimeStringForDate(new Date(last_ms));

    return el.title != ts_txt;
}//GetHasChangedCard

function UpdateLastSeens()
{
    if (_json == null) return;

    for (var i=0; i<_json.length; i++)
    {
        UpdateLastSeen(_json[i]);
    }//for
}//UpdateLastSeens

function UpdateLastSeen(dev_node)
{
    var el     = document.getElementById("lastseen_"     + dev_node.device_id);
    var el_txt = document.getElementById("lastseen_txt_" + dev_node.device_id);
    var el_tt  = document.getElementById("lastseen_tt_"  + dev_node.device_id);
    
    if (el == null) return;

    var is_offline = IsOffline(dev_node);

    if (el_txt == null)
    {
        var up_con             = document.createElement("div");
        var up_div             = document.createElement("div");
        up_con.className       = "lastseen_container";
        up_div.className       = "lastseen_arrow";
        up_div.innerHTML       = "";
        el_txt                 = document.createElement("span");
        el_txt.id              = "lastseen_txt_" + dev_node.device_id;
        up_con.appendChild(up_div);
        up_con.appendChild(el_txt);
        el.appendChild(up_con);
    }//if

    if (is_offline)
    {
        if (el.className.indexOf("err") < 0) el.className += " err";
    }//if
    else
    {
        if (el.className.indexOf("err") >= 0) el.className = el.className.replace(/err/, "");
    }//else if

    if (el_tt == null && _opts.card_show_tooltips)
    {
        el_tt            = document.createElement("span");
        el_tt.id         = "lastseen_tt_" + dev_node.device_id;
        el_tt.className  = "tooltiptext";
        el.className    += " tooltip down";
        el.appendChild(el_tt);
    }//if

    var last_ms = GetLastSeenTimeMS(dev_node);
    var ett     = _GetElapsedTimeText((last_ms / 1000.0) >>> 0);
    var ago_txt = " " + ett.value + " " + ett.text + " ago";
    var ts_txt  = _GetDateTimeStringForDate(new Date(last_ms));

    if (el_txt.innerHTML != ago_txt)                 el_txt.innerHTML = ago_txt;
    if (el_tt != null && el_tt.innerHTML != ts_txt ) el_tt.innerHTML  = ts_txt;

    UpdateCardOfflineStatus(dev_node);
}//UpdateLastSeen



function UpdateCardOfflineStatus(dev_node)
{
    var el  = document.getElementById("dev_"    + dev_node.device_id);
    var img = document.getElementById("offimg_" + dev_node.device_id);
    if (el == null) return;

    if (IsOffline(dev_node))
    {
        if (el.className.indexOf("err") < 0) el.className += " err";
    }//if
    else
    {
        if (el.className.indexOf("err") >= 0) el.className = el.className.replace(/err/, "");
    }//else if
}//UpdateCardOfflineStatus



function GetUnitInfo(u)
{
    var d = null;

    for (var i=0; i<_unit_info.length; i++)
    {
        if (_unit_info[i].u == u)
        {
            d = _unit_info[i];
            break;
        }//if
    }//for

    return d;
}//GetUnitInfo

function GetGroupInfo(g)
{
    var d = null;

    for (var i=0; i<_group_info.length; i++)
    {
        if (_group_info[i].group == g)
        {
            d = _group_info[i];
            break;
        }//if
    }//for

    return d;
}//GetGroupInfo

function GetPlaceNameForLatLon(lat, lon)
{
    var p = [ { y1:39.11,  x0: -77.37, y0: 38.80, x1: -76.88, st:"us.dc",    fs:"us", detail_for_flag:"DC",    name:"Washington DC, US"              },
              { y1:34.80,  x0:-120.40, y0: 33.10, x1:-117.10, st:"us.ca.la", fs:"us", detail_for_flag:"L.A.",  name:"Los Angeles, CA, US"            },
              { y1:42.00,  x0:-124.62, y0: 32.40, x1:-114.57, st:"us.ca",    fs:"us", detail_for_flag:"CA",    name:"California, US"                 },
              { y1:23.10,  x0:-161.80, y0: 18.20, x1:-153.70, st:"us.hi",    fs:"us", detail_for_flag:"HI",    name:"Hawaii, US"                     },
              { y1:42.95,  x0: -73.68, y0: 41.15, x1: -69.83, st:"us.ma",    fs:"us", detail_for_flag:"MA",    name:"Massachusetts, US"              },
              { y1:44.06,  x0: -72.07, y0: 42.88, x1: -71.00, st:"us.nh",    fs:"us", detail_for_flag:"NH",    name:"New Hampshire, US"              },
              { y1:45.01,  x0: -74.93, y0: 40.59, x1: -73.53, st:"us.ny",    fs:"us", detail_for_flag:"NY",    name:"New York, US"                   },
              { y1:37.00,  x0:-109.06, y0: 31.38, x1:-103.08, st:"us.nm",    fs:"us", detail_for_flag:"NM",    name:"New Mexico, US"                 },
              { y1:48.95,  x0:-124.88, y0: 46.03, x1:-116.97, st:"us.wa",    fs:"us", detail_for_flag:"WA",    name:"Washington, US"                 },
              { y1:46.00,  x0:-124.00, y0: 42.03, x1:-117.00, st:"us.or",    fs:"us", detail_for_flag:"OR",    name:"Oregon, US"                     },
              { y1:49.00,  x0:-126.50, y0: 24.60, x1: -65.40, st:"us",       fs:"us", detail_for_flag:null,    name:"US"                             },
              { y1:75.00,  x0:-141.00, y0: 49.01, x1: -52.10, st:"ca",       fs:"ca", detail_for_flag:null,    name:"Canada"                         },
              { y1:47.37,  x0:  13.49, y0: 45.47, x1:  16.61, st:"si",       fs:"si", detail_for_flag:null,    name:"Slovenia"                       },
              { y1:45.90,  x0:   6.86, y0: 41.14, x1:  13.57, st:"it",       fs:"it", detail_for_flag:null,    name:"Italy"                          },
              { y1:47.55,  x0:   6.11, y0: 45.85, x1:  10.33, st:"ch",       fs:"ch", detail_for_flag:null,    name:"Switzerland"                    },
              { y1:54.90,  x0:   5.20, y0: 47.70, x1:  13.80, st:"de",       fs:"de", detail_for_flag:null,    name:"Germany"                        },
              { y1:22.54,  x0: 113.78, y0: 21.83, x1: 114.64, st:"hk",       fs:"hk", detail_for_flag:null,    name:"Hong Kong SAR, China"           },
              { y1:26.00,  x0: 120.00, y0:  1.80, x1: 122.10, st:"tw",       fs:"tw", detail_for_flag:null,    name:"Taiwan"                         },
              { y1:36.04,  x0: 139.25, y0: 35.30, x1: 140.33, st:"jp.to",    fs:"jp", detail_for_flag:"",   name:"Tokyo Prefecture, Japan"        },
              { y1:38.20,  x0: 138.77, y0: 36.71, x1: 141.20, st:"jp.fu",    fs:"jp", detail_for_flag:"",   name:"Fukushima Prefecture, Japan"    },
              { y1:34.91,  x0: 135.31, y0: 33.49, x1: 136.89, st:"jp.na",    fs:"jp", detail_for_flag:"",   name:"Nara Prefecture, Japan"         },
              { y1:33.03,  x0: 130.42, y0: 32.14, x1: 130.99, st:"jp.ku",    fs:"jp", detail_for_flag:"",   name:"Kumamoto Prefecture, Japan"     },
              { y1:32.09,  x0: 130.02, y0: 31.04, x1: 131.13, st:"jp.ka",    fs:"jp", detail_for_flag:"", name:"Kagoshima Prefecture, Japan"    },
              { y1:36.92,  x0: 140.20, y0: 35.93, x1: 140.73, st:"jp.ib",    fs:"jp", detail_for_flag:"",   name:"Ibaraki Prefecture, Japan"      },
              { y1:35.81,  x0: 134.84, y0: 34.71, x1: 136.04, st:"jp.ky",    fs:"jp", detail_for_flag:"",   name:"Kyoto Prefecture, Japan"        },
              { y1:35.44,  x0: 135.84, y0: 35.02, x1: 136.40, st:"jp.sh",    fs:"jp", detail_for_flag:"",   name:"Shiga Prefecture, Japan"        },
              { y1:45.80,  x0: 124.80, y0: 23.20, x1: 153.00, st:"jp",       fs:"jp", detail_for_flag:null,    name:"Japan"                          },
              { y1:53.50,  x0:   3.17, y0: 51.38, x1:   6.53, st:"nl",       fs:"nl", detail_for_flag:null,    name:"Netherlands"                    },
              { y1:90.00,  x0:-180.00, y0:-90.00, x1: 180.00, st:"zz",       fs:"xx", detail_for_flag:null,    name:"(No Extent Match) Earth"        } ];
              
    var d = null;

    for (var i=0; i<p.length; i++)
    {
        if (   lat >= p[i].y0 && lat <= p[i].y1
            && lon >= p[i].x0 && lon <= p[i].x1)
        {
            d = p[i];
            break;
        }//if
    }//for

    return d;
}//GetPlaceNameForLatLon

function JsonCpmToUsvh()
{
    var s = [ { f:334.0, us:["lnd_7318",  "lnd_7318u",  "lnd_7318c"] },
              { f:120.5, us:["lnd_7128",  "lnd_7128ec", "lnd_712",    "lnd_712u",  "lnd_712c"] },
              { f:990.0, us:["lnd_78017", "lnd_78017u", "lnd_78017c", "lnd_78017w"] } ];

    for (var i=0; i<_json.length; i++)
    {
        for (var j=0; j<_json[i].units.length; j++)
        {
            if (_json[i].units[j].did_cpm2usv == null)
            {
                for (var k=0; k<s.length; k++)
                {
                    for (var l=0; l<s[k].us.length; l++)
                    {
                        if (_json[i].units[j].unit == s[k].us[l])
                        {
                            _json[i].units[j].stats.min  /= s[k].f;
                            _json[i].units[j].stats.max  /= s[k].f;
                            _json[i].units[j].stats.val  /= s[k].f;
                            _json[i].units[j].did_cpm2usv = true;
                            break;
                        }//if
                    }//for

                    if (_json[i].units[j].did_cpm2usv) break;
                }//for
            }//if
        }//for
    }//for
}//JsonCpmToUsvh

function AddLocSortStringToJson()
{
    for (var i=0; i<_json.length; i++)
    {
        var pn = GetPlaceName(_json[i]);
        _json[i].loc_sort = pn == null ? "zz" : pn.st;
    }//for
}//AddLocSortStringToJson

function AddDeviceAgeOrdinalToJson()
{
    var s = GetDeviceAges();
    if (s == null) return;

    for (var i=0; i<_json.length; i++)
    {
        _json[i].device_age_ordinal = GetDeviceAgeOrdinal(_json[i], s);
    }//for
}//AddDeviceAgeOrdinalToJson


function GetDeviceAgeOrdinal(dev_node, s)
{
    var idx = -1;
    if (s == null) s = GetDeviceAges();
    if (s == null) return idx;

    for (var i=0; i<s.length; i++)
    {
        if (s[i].device_id == dev_node.device_id)
        {
            idx = i;
            break;
        }//if
    }//for
    
    return idx;
}//GetDeviceAgeOrdinal

function GetDeviceAges()
{
    if (_json == null) return null;

    var d = new Array();

    for (var i=0; i<_json.length; i++)
    {
        d.push( { ms:GetOldestTimeMS(_json[i]), device_id:_json[i].device_id } );
    }//for

    d = d.sort(function(a, b) 
    {
        return   a["ms"]        > b["ms"]        ?  1
               : a["ms"]        < b["ms"]        ? -1 
               : a["device_id"] > b["device_id"] ?  1
               : a["device_id"] < b["device_id"] ? -1
               : 0;
    });

    return d;
}//GetDeviceAges


var _group_info = [  { group:0, emoji:"", title:"Bat",   sort_ordinal:6 }
                    ,{ group:1, emoji:"", title:"Env",   sort_ordinal:7 }
                    ,{ group:2, emoji:"", title:"Enc",   sort_ordinal:8 }
                    ,{ group:3, emoji:"", title:"OPC",   sort_ordinal:1 }
                    ,{ group:4, emoji:"", title:"PMS",   sort_ordinal:2 }
                    ,{ group:5, emoji:"", title:"LNDu",  sort_ordinal:3 }
                    ,{ group:6, emoji:"", title:"LNDc",  sort_ordinal:4 }
                    ,{ group:7, emoji:"", title:"LNDec", sort_ordinal:5 }
                    ,{ group:8, emoji:"", title:"Loc",   sort_ordinal:9 } ];



function IsOorForUnit(x, unit)
{
    return    (unit == 'bat_charge'      && (x <     0.00 || x >= 100.5))
           || (unit == 'bat_current'     && (x < -1450.00 || x >  360.0))
           || (unit == 'bat_voltage'     && (x <     2.50 || x >   10.0))
           || (unit == 'env_humid'       && (x <     0.00 || x >= 100.5))
           || (unit == 'env_press'       && (x <    10.00 || x >  150.0))
           || (unit == 'env_temp'        && (x <   -10.00 || x >   80.0))
           || (unit == 'dev_humid'       && (x <     0.00 || x >  100.0))
           || (unit == 'dev_press'       && (x <    10.00 || x >  150.0))
           || (unit == 'dev_temp'        && (x <   -10.00 || x >   80.0))
           || (unit.indexOf('lnd_') > -1 && (x <     0.02 || x >    1.0))
           || (unit.indexOf('_pm')  > -1 && (x <     0.00 || x >   80.0));
}//IsOorForUnit

/*
var _unit_info = [   { u:"bat_charge",  si:"%",     st:" {x}%",   group:0, sort_ordinal:1, decs:0 }
                    ,{ u:"bat_current", si:"mA",    st:" {x}",   group:0, sort_ordinal:2, decs:1 }
                    ,{ u:"bat_voltage", si:"V",     st:" {x}V",   group:0, sort_ordinal:3, decs:1 }
                    ,{ u:"env_humid",   si:"RH%",   st:" {x}%",   group:1, sort_ordinal:1, decs:0 }
                    ,{ u:"env_press",   si:"hPa",   st:" {x}",   group:1, sort_ordinal:2, decs:0 } //  
                    ,{ u:"env_temp",    si:"C",    st:" {x}",   group:1, sort_ordinal:3, decs:1 } // 
                    ,{ u:"dev_humid",   si:"RH%",   st:" {x}%",   group:2, sort_ordinal:1, decs:0 }
                    ,{ u:"dev_press",   si:"hPa",   st:" {x}",   group:2, sort_ordinal:2, decs:0 }
                    ,{ u:"dev_temp",    si:"C",    st:" {x}",   group:2, sort_ordinal:3, decs:1 }    //
                    ,{ u:"opc_pm01_0",  si:"g/m", st:"1 {x}",   group:3, sort_ordinal:1, decs:2 }
                    ,{ u:"opc_pm02_5",  si:"g/m", st:"2 {x}",   group:3, sort_ordinal:2, decs:2 }
                    ,{ u:"opc_pm10_0",  si:"g/m", st:" {x}",    group:3, sort_ordinal:3, decs:2 }
                    ,{ u:"pms_pm01_0",  si:"g/m", st:"1 {x}",   group:4, sort_ordinal:1, decs:2 }
                    ,{ u:"pms_pm02_5",  si:"g/m", st:"2 {x}",   group:4, sort_ordinal:2, decs:2 }
                    ,{ u:"pms_pm10_0",  si:"g/m", st:" {x}",    group:4, sort_ordinal:3, decs:2 }
                  //,{ u:"lnd_712",     si:"Sv/h", st:" {x}",     group:5, sort_ordinal:1, decs:2 }
                    ,{ u:"lnd_712u",    si:"Sv/h", st:" {x}",     group:5, sort_ordinal:2, decs:2 }
                  //,{ u:"lnd_7318",    si:"Sv/h", st:" {x}",     group:5, sort_ordinal:3, decs:2 }
                    ,{ u:"lnd_7318u",   si:"Sv/h", st:" {x}",     group:5, sort_ordinal:4, decs:2 }
                  //,{ u:"lnd_78017",   si:"Sv/h", st:" {x}",     group:5, sort_ordinal:5, decs:2 }
                  //,{ u:"lnd_78017u",  si:"Sv/h", st:" {x}",     group:5, sort_ordinal:6, decs:2 }
                  //,{ u:"lnd_712c",    si:"Sv/h", st:" {x}",     group:6, sort_ordinal:1, decs:2 }
                    ,{ u:"lnd_7318c",   si:"Sv/h", st:" {x}",     group:6, sort_ordinal:2, decs:2 }
                  //,{ u:"lnd_78017c",  si:"Sv/h", st:" {x}",     group:6, sort_ordinal:3, decs:2 }
                    ,{ u:"lnd_78017w",  si:"Sv/h", st:" {x}",     group:6, sort_ordinal:4, decs:2 }
                  //,{ u:"lnd_7128",    si:"Sv/h", st:" {x}",     group:7, sort_ordinal:1, decs:2 } 
                    ,{ u:"lnd_7128ec",  si:"Sv/h", st:" {x}",     group:7, sort_ordinal:2, decs:2 } 
                    ,{ u:"loc_lat",     si:"",     st:" {x}",   group:8, sort_ordinal:1, decs:2 } 
                    ,{ u:"loc_lon",     si:"",     st:" {x}",   group:8, sort_ordinal:2, decs:2 } ];
*/


var _unit_info = [   { u:"bat_charge",  si:"%",     min_ic:"battery",           min_suffix:"%",   group:0, sort_ordinal:1, decs:0 }
                    ,{ u:"bat_current", si:"mA",    min_ic:"battery",           min_suffix:"",   group:0, sort_ordinal:2, decs:1 }
                    ,{ u:"bat_voltage", si:"V",     min_ic:"battery",           min_suffix:"V",   group:0, sort_ordinal:3, decs:1 }
                    ,{ u:"env_humid",   si:"RH%",   min_ic:"thermometer",       min_suffix:"%",   group:1, sort_ordinal:1, decs:0 }
                    ,{ u:"env_press",   si:"hPa",   min_ic:"thermometer",       min_suffix:"",   group:1, sort_ordinal:2, decs:0 } //  
                    ,{ u:"env_temp",    si:"C",    min_ic:"thermometer",       min_suffix:"",   group:1, sort_ordinal:3, decs:1 } // 
                    ,{ u:"dev_humid",   si:"RH%",   min_ic:"thermometer_blue",  min_suffix:"%",   group:2, sort_ordinal:1, decs:0 }
                    ,{ u:"dev_press",   si:"hPa",   min_ic:"thermometer_blue",  min_suffix:"",   group:2, sort_ordinal:2, decs:0 }
                    ,{ u:"dev_temp",    si:"C",    min_ic:"thermometer_blue",  min_suffix:"",   group:2, sort_ordinal:3, decs:1 }    //
                    ,{ u:"opc_pm01_0",  si:"g/m", min_ic:"one",                                 group:3, sort_ordinal:1, decs:1 }
                    ,{ u:"opc_pm02_5",  si:"g/m", min_ic:"two",                                 group:3, sort_ordinal:2, decs:1 }
                    ,{ u:"opc_pm10_0",  si:"g/m", min_ic:"keycap_ten",                          group:3, sort_ordinal:3, decs:1 }
                    ,{ u:"pms_pm01_0",  si:"g/m", min_ic:"one",                                 group:4, sort_ordinal:1, decs:1 }
                    ,{ u:"pms_pm02_5",  si:"g/m", min_ic:"two",                                 group:4, sort_ordinal:2, decs:1 }
                    ,{ u:"pms_pm10_0",  si:"g/m", min_ic:"keycap_ten",                          group:4, sort_ordinal:3, decs:1 }
                  //,{ u:"lnd_712",     si:"Sv/h", min_ic:"radioactive_sign",                    group:5, sort_ordinal:1, decs:2 }
                    ,{ u:"lnd_712u",    si:"Sv/h", min_ic:"radioactive_sign",                    group:5, sort_ordinal:2, decs:2 }
                  //,{ u:"lnd_7318",    si:"Sv/h", min_ic:"radioactive_sign",                    group:5, sort_ordinal:3, decs:2 }
                    ,{ u:"lnd_7318u",   si:"Sv/h", min_ic:"radioactive_sign",                    group:5, sort_ordinal:4, decs:2 }
                  //,{ u:"lnd_78017",   si:"Sv/h", min_ic:"radioactive_sign",                    group:5, sort_ordinal:5, decs:2 }
                  //,{ u:"lnd_78017u",  si:"Sv/h", min_ic:"radioactive_sign",                    group:5, sort_ordinal:6, decs:2 }
                  //,{ u:"lnd_712c",    si:"Sv/h", min_ic:"radioactive_sign",                    group:6, sort_ordinal:1, decs:2 }
                    ,{ u:"lnd_7318c",   si:"Sv/h", min_ic:"radioactive_sign",                    group:6, sort_ordinal:2, decs:2 }
                  //,{ u:"lnd_78017c",  si:"Sv/h", min_ic:"radioactive_sign",                    group:6, sort_ordinal:3, decs:2 }
                    ,{ u:"lnd_78017w",  si:"Sv/h", min_ic:"radioactive_sign",                    group:6, sort_ordinal:4, decs:2 }
                  //,{ u:"lnd_7128",    si:"Sv/h", min_ic:"radioactive_sign",                    group:7, sort_ordinal:1, decs:2 } 
                    ,{ u:"lnd_7128ec",  si:"Sv/h", min_ic:"radioactive_sign",                    group:7, sort_ordinal:2, decs:2 } 
                    ,{ u:"loc_lat",     si:"",     min_ic:"earth_asia",        min_suffix:"y",   group:8, sort_ordinal:1, decs:2 } 
                    ,{ u:"loc_lon",     si:"",     min_ic:"earth_asia",        min_suffix:"x",   group:8, sort_ordinal:2, decs:2 } ];


    var _SortJsonByLoc = function(src)
    {
        src = src.sort(function(a, b) 
        {
            return   a["loc_sort"]  > b["loc_sort"]  ?  1
                   : a["loc_sort"]  < b["loc_sort"]  ? -1 
                   : a["device_id"] > b["device_id"] ?  1
                   : a["device_id"] < b["device_id"] ? -1 
                   : 0;
        });

        return src;
    };

    var _SortJsonByDeviceAgeOrdinal = function(src)
    {
        src = src.sort(function(a, b) 
        {
            return   a["device_age_ordinal"] < b["device_age_ordinal"] ?  1
                   : a["device_age_ordinal"] > b["device_age_ordinal"] ? -1 
                   : a["device_id"]          > b["device_id"]          ?  1
                   : a["device_id"]          < b["device_id"]          ? -1 
                   : 0;
        });
        
        return src;
    };

    var _SortJsonByDeviceId = function(src)
    {
        src = src.sort(function(a, b) 
        {
            return   a["device_id"] > b["device_id"] ?  1
                   : a["device_id"] < b["device_id"] ? -1 
                   : 0;
        });
        
        return src;
    };

    var _SortUnitsByUnit = function(src)
    {
        src = src.sort(function(a, b) 
        {
            var a_unit_info  = GetUnitInfo(a["unit"]);
            var b_unit_info  = GetUnitInfo(b["unit"]);
            var a_group_info = GetGroupInfo(a_unit_info.group);
            var b_group_info = GetGroupInfo(b_unit_info.group);

            return   a_group_info.sort_ordinal > b_group_info.sort_ordinal ?  1
                   : a_group_info.sort_ordinal < b_group_info.sort_ordinal ? -1 
                   : a_unit_info.sort_ordinal  > b_unit_info.sort_ordinal  ?  1
                   : a_unit_info.sort_ordinal  < b_unit_info.sort_ordinal  ? -1
                   : 0;
        });
        
        return src;
    };


    var _GetElapsedTimeText = function(unixSS)
    {
        unixSS     = parseFloat(unixSS);
        var nowSS  = Date.now() / 1000.0;
        var diffSS = nowSS - unixSS;
        var dest   = null;
        var trs    = new Array();
        
        if (diffSS < 1.0) diffSS = 1.0;
        
        trs.push(["sec",           1, ""]);
        trs.push(["min",          60, ""]);
        trs.push(["hour",       3600, ""]);
        trs.push(["day",       86400, ""]);
        trs.push(["week",    7*86400, ""]);
        trs.push(["month",  28*86400, ""]);
        trs.push(["year",  365*86400, ""]);
        
        for (var i=0; i<trs.length - 1; i++)
        {
            if (diffSS < trs[i+1][1]
                && Math.round(diffSS / trs[i][1]) * trs[i][1] < trs[i+1][1]) // above is probably redundant
            {
                dest = { value:trs[i][1], text:trs[i][0], jptext:trs[i][2] };
                break;
            }//if
        }//for
        
        if (dest == null) dest = { value:trs[trs.length-1][1], text:trs[trs.length-1][0], jptext:trs[trs.length-1][2] };
        
        dest.value = Math.round(diffSS / dest.value);

        if (dest.value > 1.0 && dest.text != "sec" && dest.text != "min") dest.text += "s";

        return dest;
    };

    var _Pad2                               = function(x) { return x < 10 ? "0"+x : ""+x; };
    var _GetFormattedTimeStringForDate      = function(d) { return _Pad2(d.getHours()) + ":" + _Pad2(d.getMinutes()); };
    var _GetFormattedDateStringForDate      = function(d) { return d.getFullYear()  + "-" + _Pad2(d.getMonth()+1) + "-" + _Pad2(d.getDate()); };
    var _GetFormattedUtcOffsetStringForDate = function(d) { return "UTC" + (d.getTimezoneOffset() > 0 ? "-" : "+") + _Pad2(Math.abs(d.getTimezoneOffset()/60)); };
    var _GetTzAbbrStringForDate             = function(d) {
        var tz = d.toLocaleString("en", {timeZoneName:"short"}).split(" ").pop();
        if (tz.length > 3 && tz.indexOf("GMT") > -1) // fix for JST resolving to "GMT-9" with the short tz specification.
        {
            var tzl = d.toString().split("(")[1].slice(0, -1);
            if (tzl.length < tz.length) tz = tzl;
        }//if
        return tz; };
    var _GetDateTimeStringForDate           = function(d) {
        var gmt = _GetFormattedUtcOffsetStringForDate(d);
        var tza = _GetTzAbbrStringForDate(d);
        return _GetFormattedDateStringForDate(d) + " " + _GetFormattedTimeStringForDate(d) + " " + gmt + " (" + tza + ")"; };
    var _GetDateTimeHtmlForDate             = function(d) {
        var g = _GetFormattedUtcOffsetStringForDate(d);
        var a = _GetTzAbbrStringForDate(d);
        return   "<span style='color:#555;'>" + _GetFormattedDateStringForDate(d) + "</span>" + "&nbsp;&nbsp;"
               + "<span style='color:#000;'>" + _GetFormattedTimeStringForDate(d) + "</span>" + " &nbsp;"
               + "<span style='color:#CCC;'>" + g + " (" + a + ")</span>"; };


function AddNameToHighlights(n)
{
    var nh  = new Array();
    var csv = "";
    var el  = document.getElementById("txtHighlights");

    for (var i=0; i<_highlights.length; i++)
    {
        if (_highlights[i] != n) nh.push(_highlights[i]);
    }//for

    if (nh.length == _highlights.length) nh.push(n);

    for (var i=0; i<nh.length; i++)
    {
        csv += nh[i] + (i < nh.length - 1 ? "," : "");
    }//for

    el.value    = csv;
    _highlights = nh;

    _LocalStorageSetWrapper("highlights", csv);
    UpdateQueryString();
}//AddNameToHighlights

function CSVtoHighlights(dest, csv)
{
    if (csv == null || csv.length == 0) return;
    
    var arS = csv.split(",");
    
    for (var i=0; i<arS.length; i++)
    {
        dest.push(arS[i].trim());
    }//for
}//CSVtoHighlights

function UpdateHighlights()
{
    _highlights = new Array();
    CSVtoHighlights(_highlights, document.getElementById("txtHighlights").value);
}//UpdateHighlights

function IsHighlight(name)
{
    var src = _highlights;
    var isH = false;
    var _n  = name.toString().toLowerCase();
    
    for (var i=0; i<src.length; i++)
    {
        if (src[i].toLowerCase().localeCompare(_n) == 0)
        {
            isH = true;
            break;
        }//if
    }//for
    
    return isH;
}//IsHighlight

function ToggleOptions()
{
    var tbl           = document.getElementById("tblOptions");
    var btn           = document.getElementById("btnOptions");
    tbl.style.display = tbl.style.display == null || tbl.style.display.length == 0 ? "none"         : null;
    btn.innerHTML     = tbl.style.display == null || tbl.style.display.length == 0 ? "Hide Options" : "Show Options";
}//ToggleOptions

function ClearAllContent()
{
    var content = document.getElementById("content");
    
    while (content.firstChild) 
    {
        content.removeChild(content.firstChild);
    }//while
}//ClearAllContent

function ForceReloadAll()
{
    ClearAllContent();
    if (_json != null) AddOrUpdateJson(_json);
    _last_forced_reload = Date.now();
}//ForceReloadAll

function ToggleOptsChk(opts_prop_name)
{
    _opts[opts_prop_name] = !_opts[opts_prop_name];
    SetPref_Boolean(opts_prop_name, _opts[opts_prop_name]);
    ForceReloadAll();
}//ToggleOptsChk

function ddlSortBy_OnChange()
{
    var e = document.getElementById("ddlSortBy");
    var v = parseInt(e.options[e.selectedIndex].value);

    switch (v)
    {
        case 0:
            _opts.sort_age_ordinal = false;
            _opts.sort_loc         = false;
            break;
        case 1:
            _opts.sort_age_ordinal = true;
            _opts.sort_loc         = false;        
            break;
        case 2:
            _opts.sort_age_ordinal = false;
            _opts.sort_loc         = true;        
            break;
    }//switch

    SetPref_Boolean("sort_age_ordinal", _opts.sort_age_ordinal);
    SetPref_Boolean("sort_loc",         _opts.sort_loc);
    ForceReloadAll();
}//ddlSortBy_OnChange

function BindOptionToChk(prop_name)
{
    var el = document.getElementById("chk_" + prop_name);
    if (el != null) el.checked = _opts[prop_name];
}//BindOptionToChk

function BindOptions()
{
    for (var key in _opts)
    {
        if (typeof _opts[key] == "boolean" || _opts[key] instanceof Boolean)
        {
            BindOptionToChk(key);
        }//if
    }//for

    var tre = document.getElementById("trOptsEnd");

    for (var i=0; i<_unit_info.length; i++)
    {
        var tr  = document.createElement("tr");
        var td0 = tr.insertCell(-1);
        var td1 = tr.insertCell(-1);
        var td2 = tr.insertCell(-1);
        var td3 = tr.insertCell(-1);
        var td4 = tr.insertCell(-1);
        var chk = document.createElement("input");
        td0.className   = "label";
        td1.className   = "label";
        td2.className   = "label";
        td2.style.align = "right";
        td0.innerHTML   = "Measurements";
        td1.innerHTML   = "Units";
        td2.innerHTML   = _unit_info[i].u;
        chk.type        = "checkbox";
        chk.id          = "chk_card_show_tbl_"   + _unit_info[i].u;
        chk.value       = "card_show_tbl_"       + _unit_info[i].u;
        chk.checked     = _opts["card_show_tbl_" + _unit_info[i].u];
        chk.addEventListener("click", function(e)
        {
            ToggleOptsChk(this.value);
        }.bind(chk), false);

        td3.appendChild(chk);
        tre.parentElement.insertBefore(tr, tre);
    }//for

    document.getElementById("ddlSortBy").selectedIndex = _opts.sort_age_ordinal ? 1 : _opts.sort_loc ? 2 : 0;
}//BindOptions

function _LocalStorageSetWrapper(key, value)
{
    localStorage.setItem(_local_storage_prefix + key, value);
}//_LocalStorageSetWrapper

function _LocalStorageGetWrapper(key)
{
    return localStorage.getItem(_local_storage_prefix + key);
}//_LocalStorageGetWrapper

function GetPref_Boolean(k, d)
{
    var v = _LocalStorageGetWrapper(k);
    return v == null ? d : parseInt(v) == 1;
}//GetPref_Boolean

function SetPref_Boolean(k, v)
{
    _LocalStorageSetWrapper(k, v ? 1 : 0);
}//SetPref_Boolean

function GetQueryStringForOptions()
{
    var d = "";

    for (var key in _opts)
    {
        if (!IsOptionsKeyValueDefault(key, _opts[key])
            && (typeof _opts[key] == "boolean" || _opts[key] instanceof Boolean))
        {
            if (d.length > 1) d += "&";
            d += key + "=" + (_opts[key] ? 1 : 0);
        }//if
    }//for

    if (_highlights.length > 0)
    {
        if (d.length > 1) d += "&";

        var csv = _LocalStorageGetWrapper("highlights");

        d += "highlights=" + csv;
    }//if

    return (d.length > 0 ? "?" : "") + d;
}//GetQueryStringForOptions

function LoadOptionsFromPrefs()
{
    if (_LocalStorageGetWrapper("card_show_tbl_loc_lat")   == null) _LocalStorageSetWrapper("card_show_tbl_loc_lat",   0);
    if (_LocalStorageGetWrapper("card_show_tbl_loc_lon")   == null) _LocalStorageSetWrapper("card_show_tbl_loc_lon",   0);
    //if (localStorage.getItem("card_show_tbl_dev_temp")  == null) localStorage.setItem("card_show_tbl_dev_temp",  0);
    if (_LocalStorageGetWrapper("card_show_tbl_dev_press") == null) _LocalStorageSetWrapper("card_show_tbl_dev_press", 0);
    if (_LocalStorageGetWrapper("card_show_tbl_dev_humid") == null) _LocalStorageSetWrapper("card_show_tbl_dev_humid", 0);

    for (var key in _opts)
    {
        if (typeof _opts[key] == "boolean" || _opts[key] instanceof Boolean) _opts[key] = GetPref_Boolean(key, _opts[key]);
    }//for

    for (var i=0; i<_unit_info.length; i++)
    {
        _opts["card_show_tbl_" + _unit_info[i].u] = GetPref_Boolean("card_show_tbl_" + _unit_info[i].u, true);
    }//for

    var ph = _LocalStorageGetWrapper("highlights");
    if (ph != null)
    {
        document.getElementById("txtHighlights").value = ph;
        UpdateHighlights();
    }//if
}//LoadOptionsFromPrefs


function IsAnySavedPrefs()
{
    var d = false;

    for (var key in _opts)
    {
        var v = null;
        if (typeof _opts[key] == "boolean" || _opts[key] instanceof Boolean) v = GetPref_Boolean(key, _opts[key]);

        d = v != null && !IsOptionsKeyValueDefault(key, v);
        if (d) break;
    }//for

    if (!d)
    {
        for (var i=0; i<_unit_info.length; i++)
        {
            var v = GetPref_Boolean("card_show_tbl_" + _unit_info[i].u, true);
            d = !IsOptionsKeyValueDefault("card_show_tbl_" + _unit_info[i].u, v);
            if (d) break;
        }//for
    }//if

    if (!d) d = _LocalStorageGetWrapper("highlights") != null;

    return d;
}//IsAnySavedPrefs


function GetOptionsFromQueryString()
{
    for (var key in _opts)
    {
        if (typeof _opts[key] == "boolean" || _opts[key] instanceof Boolean)
        {
            var p = _QueryString_GetParamAsInt(key);
            if (p > -1) SetPref_Boolean(key, p == 1);
        }//if
    }//for

    for (var i=0; i<_unit_info.length; i++)
    {
        var key = "card_show_tbl_" + _unit_info[i].u;
        var p = _QueryString_GetParamAsInt(key);
        if (p > -1) SetPref_Boolean(key, p == 1);
    }//for

    var h = _QueryString_GetParam("highlights");

    if (h.length > 0)
    {
        _LocalStorageSetWrapper("highlights", h);
    }//if
}//GetOptionsFromQueryString

var _QueryString_GetAllParams = function()
{
    var d = new Array();

    if (window.location.href.indexOf("?") > -1)
    {
        var s0 = window.location.href.split("?")[1].split("&");

        for (var i=0; i<s0.length; i++)
        {
            var s1 = s0.split("=");
            d.push( { k:s0[0], v:s0[1] } );
        }//for
    }//if

    return d;
};

var _QueryString_GetParamAsInt = function(paramName) // -1 if string was null
{
    var sp = _QueryString_GetParam(paramName);
    return sp != null && sp.length > 0 ? parseInt(sp) : -1;
};

var _QueryString_IsParamEqual = function(paramName, compareValue)
{
    var retVal = false;

    if (paramName != null)
    {
        var p  = _QueryString_GetParam(paramName);
        retVal = p != null && p.length > 0 && p == compareValue;
    }//if

    return retVal;
};

var _QueryString_GetParam = function(name) 
{
    name        = name.replace(/[\[]/, "\\\[").replace(/[\]]/, "\\\]");
    var regexS  = "[\\?&]" + name + "=([^&#]*)";
    var regex   = new RegExp(regexS);
    var results = regex.exec(window.location.href);

    return results == null ? "" : results[1];
};

function IsOptionsKeyValueDefault(key, value)
{
    if (key == "highlights")     return value == null || value.length == 0;
    if (_opts_defs[key] != null) return _opts_defs[key] == value;

    if (key == "card_show_tbl_loc_lat") return value == false;
    if (key == "card_show_tbl_loc_lon") return value == false;

    return true;
}//IsOptionsKeyValueDefault

// Migrates old (pre-2017-05-10) localstorage key names to the new (2017-05-10) wrapped form with a prefix
function MigrateLocalStorageKeyNames()
{
    var a = new Array();

    for (var key in _opts_defs)
    {
        if (localStorage.getItem(key) != null)
        {
            a.push([key, localStorage.getItem(key)]);
        }//if
    }//for

    for (var i=0; i<_unit_info.length; i++)
    {
        var key = "card_show_tbl_" + _unit_info[i].u;
        
        if (localStorage.getItem(key) != null)
        {
            a.push([key, localStorage.getItem(key)]);
        }//if
    }//for

    if (localStorage.getItem("highlights") != null)
    {
        a.push(["highlights", localStorage.getItem("highlights")]);
    }//if

    for (var i=0; i<a.length; i++)
    {
        localStorage.removeItem(a[i][0]);
        _LocalStorageSetWrapper(a[i][0], a[i][1]);
    }//for
}//MigrateLocalStorageKeyNames

function ResetLocalOptionsIfQuerystring()
{
    if (window.location.href.indexOf("?") > -1)
    {
        var a = new Array();

        for (var i=0; i<localStorage.length; i++)
        {
            var key = localStorage.key(i);

            if (key.length > _local_storage_prefix.length && key.substring(0,_local_storage_prefix.length) == _local_storage_prefix)
            {
                a.push(key);
            }//if
        }//for

        for (var i=0; i<a.length; i++)
        {
            localStorage.removeItem(a[i]);
        }//for
    }//if
}//ResetLocalOptionsIfQuerystring

function InitOptions()
{
    MigrateLocalStorageKeyNames();
    ResetLocalOptionsIfQuerystring();

    _opts = { };

    for (var key in _opts_defs)
    {
        _opts[key] = _opts_defs[key];
    }//for

    if (window.location.href.indexOf("?") == -1 && IsAnySavedPrefs())
    {
        var a = document.getElementById("alert");
        a.style.display = "block";
        a.className += " alertfade";
        setTimeout(function() {
            a.style.display = "none";
        }.bind(this), 5100);
    }//if

    GetOptionsFromQueryString();
    LoadOptionsFromPrefs();
    BindOptions();
}//InitOptions


function Init()
{
    InitOptions();
    _interval_tsupdate = setInterval(UpdateLastSeens, 1000);
    WordsInit();
    var url = "https://s3-us-west-2.amazonaws.com/safecastdata-us-west-2/ingest/prd/json/view_dstats.json";
    GetJSONAsync(url);
}//Init
</script>

</head>
<body onload="Init();" >
<div id="alert">Options loaded from last session.</div>
<div id="content"></div>
<button id="btnOptions" class="btn" onClick="ToggleOptions();">Show Options</button> <span id="filter_msg"></span>

<table class="tbl" id="tblOptions" style="display:none;">
    <tr>
        <td class="label">Style</td>
        <td class="label">Theme</td>
        <td class="label" align="right">Dark: </td>
        <td><input id="chk_theme_kuro" type="checkbox" onclick="ToggleOptsChk('theme_kuro');"></td>
        <td class="label">(dark theme with dark background and rounder styling)</td>
    </tr>
    <tr>
        <td class="label">Style</td>
        <td class="label">Card Height</td>
        <td class="label" align="right">Tall: </td>
        <td><input id="chk_card_tall" type="checkbox" onclick="ToggleOptsChk('card_tall');"></td>
        <td class="label">(taller, portrait-orientation cards)</td>
    </tr>
    <tr>
        <td class="label">Style</td>
        <td class="label">Font Size</td>
        <td class="label" align="right">Larger Font: </td>
        <td><input id="chk_card_tbl_mini_largerfont" type="checkbox" onclick="ToggleOptsChk('card_tbl_mini_largerfont');"></td>
        <td class="label">(warning: may cause clipping. mostly intended for "tall" view.)</td>
    </tr>
    <tr>
        <td class="label">Style</td>
        <td class="label">Background</td>
        <td class="label" align="right">Gradient: </td>
        <td><input id="chk_card_show_bkg_grad" type="checkbox" onclick="ToggleOptsChk('card_show_bkg_grad');"></td>
        <td></td>
    </tr>
    <tr>
        <td class="label">Style</td>
        <td class="label">Background</td>
        <td class="label" align="right">Flag Overlay: </td>
        <td><input id="chk_card_show_bkg_flag" type="checkbox" onclick="ToggleOptsChk('card_show_bkg_flag');"></td>
        <td class="label">(device must have location.  subtle texture; 5% opacity, luminance layer blend.)</td>
    </tr>
    <tr>
        <td class="label">Age</td>
        <td class="label">&nbsp;</td>
        <td class="label" align="right">Ordinal: </td>
        <td><input id="chk_card_show_age_ordinal" type="checkbox" onclick="ToggleOptsChk('card_show_age_ordinal');"></td>
        <td class="label">(number on top-left of device card; 1=oldest)</td>
    </tr>
    <tr>
        <td class="label">Tooltips</td>
        <td class="label">&nbsp;</td>
        <td class="label" align="right">Enable: </td>
        <td><input id="chk_card_show_tooltips" type="checkbox" onclick="ToggleOptsChk('card_show_tooltips');"></td>
        <td></td>
    </tr>
    <tr>
        <td class="label">Location</td>
        <td class="label">Icons</td>
        <td class="label" align="right">Flag: </td>
        <td><input id="chk_card_show_icon_loc" type="checkbox" onclick="ToggleOptsChk('card_show_icon_loc');"></td>
        <td></td>
    </tr>
    <tr>
        <td class="label">Device</td>
        <td class="label">Subheading</td>
        <td class="label" align="right">Info Links: </td>
        <td><input id="chk_card_show_tt_links" type="checkbox" onclick="ToggleOptsChk('card_show_tt_links');"></td>
        <td></td>
    </tr>
    <tr>
        <td class="label">Device</td>
        <td class="label">Subheading</td>
        <td class="label" align="right">Words for ID: </td>
        <td><input id="chk_card_show_word_txt" type="checkbox" onclick="ToggleOptsChk('card_show_word_txt');"></td>
        <td></td>
    </tr>
    <tr>
        <td class="label">Device</td>
        <td class="label">Subheading</td>
        <td class="label" align="right">Dev Label: </td>
        <td><input id="chk_card_show_devlabel" type="checkbox" onclick="ToggleOptsChk('card_show_devlabel');"></td>
        <td></td>
    </tr>
    <tr>
        <td class="label">Measurements</td>
        <td class="label">Table</td>
        <td class="label" align="right">Enable: </td>
        <td><input id="chk_card_show_data_tbl" type="checkbox" onclick="ToggleOptsChk('card_show_data_tbl');"></td>
        <td></td>
    </tr>
    <tr>
        <td class="label">Measurements</td>
        <td class="label">Table</td>
        <td class="label" align="right">Mini View: Count, Group: </td>
        <td><input id="chk_card_show_tbl_mini" type="checkbox" onclick="ToggleOptsChk('card_show_tbl_mini');"></td>
        <td></td>
    </tr>
    <tr>
        <td class="label">Measurements</td>
        <td class="label">Table</td>
        <td class="label" align="right">Mini View: Newest, Unit: </td>
        <td><input id="chk_card_show_tbl_mnew" type="checkbox" onclick="ToggleOptsChk('card_show_tbl_mnew');"></td>
        <td></td>
    </tr>
    <tr>
        <td class="label">Measurements</td>
        <td class="label">Table</td>
        <td class="label" align="right">Headers: </td>
        <td><input id="chk_card_show_tbl_hdrs" type="checkbox" onclick="ToggleOptsChk('card_show_tbl_hdrs');"></td>
        <td></td>
    </tr>
    <tr>
        <td class="label">Measurements</td>
        <td class="label">Table</td>
        <td class="label" align="right">Use Emoji: </td>
        <td><input id="chk_card_show_tbl_emoj" type="checkbox" onclick="ToggleOptsChk('card_show_tbl_emoj');"></td>
        <td></td>
    </tr>
    <tr>
        <td class="label">Measurements</td>
        <td class="label">Table</td>
        <td class="label" align="right">Grayscale Emoji: </td>
        <td><input id="chk_card_show_tbl_egry" type="checkbox" onclick="ToggleOptsChk('card_show_tbl_egry');"></td>
        <td class="label">(force emoji to grayscale with CSS3 filters)</td>
    </tr>    
    <tr>
        <td class="label">Measurements</td>
        <td class="label">Table</td>
        <td class="label" align="right">Value Thresholds: </td>
        <td><input id="chk_card_show_tbl_thrh" type="checkbox" onclick="ToggleOptsChk('card_show_tbl_thrh');"></td>
        <td class="label">(red highlight if out of range, orange if stale; mini view newest/unit only)</td>
    </tr>
    <tr>
        <td class="label">Sort</td>
        <td class="label">&nbsp;</td>
        <td class="label" align="right">By: </td>
        <td>
            <select id="ddlSortBy" onchange="ddlSortBy_OnChange();">
                <option value="0">Device ID</option>
                <option value="1">Device Age</option>
                <option value="2">Device Location</option>
            </select>
        </td>
        <td></td>
    </tr>
    <tr>
        <td class="label">Filter</td>
        <td class="label">Dev/Test Devices</td>
        <td class="label" align="right">Hide: </td>
        <td><input id="chk_filter_devtest" type="checkbox" onclick="ToggleOptsChk('filter_devtest');"></td>
        <td class="label">(filter devices which last reported 'dev_test' as 'true')</td>
    </tr>
    <tr>
        <td class="label">Filter</td>
        <td class="label">Old Data</td>
        <td class="label" align="right">Hide: </td>
        <td><input id="chk_filter_olddata" type="checkbox" onclick="ToggleOptsChk('filter_olddata');"></td>
        <td class="label">(filter both devices and individual sensors/channels older than 24h)</td>
    </tr>
    <tr>
        <td class="label">Filter</td>
        <td class="label">Pointcast</td>
        <td class="label" align="right">Hide: </td>
        <td><input id="chk_filter_pointcast" type="checkbox" onclick="ToggleOptsChk('filter_pointcast');"></td>
        <td></td>
    </tr>
    <tr>
        <td class="label">Filter</td>
        <td class="label">Safecast Air</td>
        <td class="label" align="right">Hide: </td>
        <td><input id="chk_filter_safecastair" type="checkbox" onclick="ToggleOptsChk('filter_safecastair');"></td>
        <td></td>
    </tr>
    <tr>
        <td class="label">Filter</td>
        <td class="label">Solarcast</td>
        <td class="label" align="right">Hide: </td>
        <td><input id="chk_filter_solarcast" type="checkbox" onclick="ToggleOptsChk('filter_solarcast');"></td>
        <td></td>
    </tr>
    <tr>
        <td class="label">Filter</td>
        <td class="label">Non-Highlights</td>
        <td class="label" align="right">Hide: </td>
        <td><input id="chk_filter_nohis" type="checkbox" onclick="ToggleOptsChk('filter_nohis');"></td>
        <td class="label">(hides any device not in the below list)</td>
    </tr>
    <tr>
        <td class="label">Highlight</td>
        <td class="label">&nbsp;</td>
        <td class="label" align="right">Device IDs: </td>
        <td><textarea id="txtHighlights" style="width:100px;height:100px;" disabled="disabled" placeholder="Click on device IDs in the grid to add/remove"></textarea></td>
        <td class="label">(add/remove: in grid, click on device IDs)</td>
    </tr>
    <tr id = "trOptsEnd">
        <td colspan="5" align="center">&nbsp;</td>
    </tr>
    <tr>
        <td colspan="5" align="center" class="label">(NOTE: For radiation units, CPM has been converted to uSv/h.)</td>
    </tr>
</table>

<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="0%" height="0%">
    <defs>
        <filter id="Emboss" w>
            <feConvolveMatrix order="5 5"
                preserveAlpha="true" 
                kernelMatrix="-1 0 0 0 0 0 
                              -2 0 0 0 0 0 
                               3 0 0 0 0 0 
                               0 0 0 0 0 0 0"/>
        </filter>
        <filter id="colorize_red" color-interpolation-filters="sRGB" x="0" y="0" height="100%" width="100%">
        <feColorMatrix type="matrix"
                     values="1 0 0 0  1.00 
                             1 0 0 0  0.00 
                             1 0 0 0  0.00 
                             0 0 0 1  0"></feColorMatrix>
        </filter>
        <filter id="colorize_orange" color-interpolation-filters="sRGB" x="0" y="0" height="100%" width="100%">
        <feColorMatrix type="matrix"
                     values="0.95 0.95 0.95 0  0.05
                             0.25 0.25 0.25 0  0.25 
                             0.32 0.32 0.32 0  0.05 
                             0    0    0    1  0"></feColorMatrix>
        </filter>
    </defs>
</svg>

</body>
</html>

<!--
        <feColorMatrix type="matrix"
                     values="1.0 0 0 0  1.00 
                             1.0 0 0 0  0.00 
                             1.0 0 0 0  0.00 
                               0 0 0 1  0"></feColorMatrix>

/-->



<!--
        <feColorMatrix type="matrix"
                     values="0.95 0.95 0.95 0  0.05
                             0.25 0.25 0.25 0  0.25 
                             0.32 0.32 0.32 0  0.05 
                               0 0    0 1  0"></feColorMatrix>

/-->












